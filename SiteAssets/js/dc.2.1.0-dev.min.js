!function(){function a(a,b){"use strict";var c={version:"2.1.0-dev",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};c.chartRegistry=function(){function b(b){return b||(b=c.constants.DEFAULT_CHART_GROUP),a[b]||(a[b]=[]),b}var a={};return{has:function(b){for(var c in a)if(a[c].indexOf(b)>=0)return!0;return!1},register:function(c,d){d=b(d),a[d].push(c)},deregister:function(c,d){d=b(d);for(var e=0;e<a[d].length;e++)if(a[d][e].anchorName()===c.anchorName()){a[d].splice(e,1);break}},clear:function(b){b?delete a[b]:a={}},list:function(c){return c=b(c),a[c]}}}(),c.registerChart=function(a,b){c.chartRegistry.register(a,b)},c.deregisterChart=function(a,b){c.chartRegistry.deregister(a,b)},c.hasChart=function(a){return c.chartRegistry.has(a)},c.deregisterAllCharts=function(a){c.chartRegistry.clear(a)},c.filterAll=function(a){for(var b=c.chartRegistry.list(a),d=0;d<b.length;++d)b[d].filterAll()},c.refocusAll=function(a){for(var b=c.chartRegistry.list(a),d=0;d<b.length;++d)b[d].focus&&b[d].focus()},c.renderAll=function(a){for(var b=c.chartRegistry.list(a),d=0;d<b.length;++d)b[d].render();null!==c._renderlet&&c._renderlet(a)},c.redrawAll=function(a){for(var b=c.chartRegistry.list(a),d=0;d<b.length;++d)b[d].redraw();null!==c._renderlet&&c._renderlet(a)},c.disableTransitions=!1,c.transition=function(a,b,d,e){if(c.disableTransitions||b<=0)return a;var f=a.transition(e);return(b>=0||void 0!==b)&&(f=f.duration(b)),(d>=0||void 0!==d)&&(f=f.delay(d)),f},c.optionalTransition=function(a,b,d,e){return a?function(a){return c.transition(a,b,d,e)}:function(a){return a}},c.afterTransition=function(a,b){if(a.empty()||!a.duration)b.call(a);else{var c=0;a.each(function(){++c}).each("end",function(){--c||b.call(a)})}},c.units={},c.units.integers=function(a,b){return Math.abs(b-a)},c.units.ordinal=function(a,b,c){return c},c.units.fp={},c.units.fp.precision=function(a){var b=function(a,d){var e=Math.abs((d-a)/b.resolution);return c.utils.isNegligible(e-Math.floor(e))?Math.floor(e):Math.ceil(e)};return b.resolution=a,b},c.round={},c.round.floor=function(a){return Math.floor(a)},c.round.ceil=function(a){return Math.ceil(a)},c.round.round=function(a){return Math.round(a)},c.override=function(a,b,c){var d=a[b];a["_"+b]=d,a[b]=c},c.renderlet=function(a){return arguments.length?(c._renderlet=a,c):c._renderlet},c.instanceOfChart=function(a){return a instanceof Object&&a.__dcFlag__&&!0},c.errors={},c.errors.Exception=function(a){var b=a||"Unexpected internal error";this.message=b,this.toString=function(){return b},this.stack=(new Error).stack},c.errors.Exception.prototype=Object.create(Error.prototype),c.errors.Exception.prototype.constructor=c.errors.Exception,c.errors.InvalidStateException=function(){c.errors.Exception.apply(this,arguments)},c.errors.InvalidStateException.prototype=Object.create(c.errors.Exception.prototype),c.errors.InvalidStateException.prototype.constructor=c.errors.InvalidStateException,c.errors.BadArgumentException=function(){c.errors.Exception.apply(this,arguments)},c.errors.BadArgumentException.prototype=Object.create(c.errors.Exception.prototype),c.errors.BadArgumentException.prototype.constructor=c.errors.BadArgumentException,c.dateFormat=a.time.format("%m/%d/%Y"),c.printers={},c.printers.filters=function(a){for(var b="",d=0;d<a.length;++d)d>0&&(b+=", "),b+=c.printers.filter(a[d]);return b},c.printers.filter=function(a){var b="";return"undefined"!=typeof a&&null!==a&&(a instanceof Array?a.length>=2?b="["+c.utils.printSingleValue(a[0])+" -> "+c.utils.printSingleValue(a[1])+"]":a.length>=1&&(b=c.utils.printSingleValue(a[0])):b=c.utils.printSingleValue(a)),b},c.pluck=function(a,b){return b?function(c,d){return b.call(c,c[a],d)}:function(b){return b[a]}},c.utils={},c.utils.printSingleValue=function(a){var b=""+a;return a instanceof Date?b=c.dateFormat(a):"string"==typeof a?b=a:c.utils.isFloat(a)?b=c.utils.printSingleValue.fformat(a):c.utils.isInteger(a)&&(b=Math.round(a)),b},c.utils.printSingleValue.fformat=a.format(".2f"),c.utils.add=function(b,c,d){if("string"==typeof c&&(c=c.replace("%","")),b instanceof Date)return"string"==typeof c&&(c=+c),"millis"===d?new Date(b.getTime()+c):(d=d||"day",a.time[d].offset(b,c));if("string"==typeof c){var e=+c/100;return b>0?b*(1+e):b*(1-e)}return b+c},c.utils.subtract=function(b,c,d){if("string"==typeof c&&(c=c.replace("%","")),b instanceof Date)return"string"==typeof c&&(c=+c),"millis"===d?new Date(b.getTime()-c):(d=d||"day",a.time[d].offset(b,-c));if("string"==typeof c){var e=+c/100;return b<0?b*(1+e):b*(1-e)}return b-c},c.utils.isNumber=function(a){return a===+a},c.utils.isFloat=function(a){return a===+a&&a!==(0|a)},c.utils.isInteger=function(a){return a===+a&&a===(0|a)},c.utils.isNegligible=function(a){return!c.utils.isNumber(a)||a<c.constants.NEGLIGIBLE_NUMBER&&a>-c.constants.NEGLIGIBLE_NUMBER},c.utils.clamp=function(a,b,c){return a<b?b:a>c?c:a};var d=0;return c.utils.uniqueId=function(){return++d},c.utils.nameToId=function(a){return a.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")},c.utils.appendOrSelect=function(a,b,c){c=c||b;var d=a.select(b);return d.empty()&&(d=a.append(c)),d},c.utils.safeNumber=function(a){return c.utils.isNumber(+a)?+a:0},c.logger={},c.logger.enableDebugLog=!1,c.logger.warn=function(a){return console&&(console.warn?console.warn(a):console.log&&console.log(a)),c.logger},c.logger.debug=function(a){return c.logger.enableDebugLog&&console&&(console.debug?console.debug(a):console.log&&console.log(a)),c.logger},c.logger.deprecate=function(a,b){function e(){return d||(c.logger.warn(b),d=!0),a.apply(this,arguments)}var d=!1;return e},c.events={current:null},c.events.trigger=function(a,b){return b?(c.events.current=a,void setTimeout(function(){a===c.events.current&&a()},b)):void a()},c.filters={},c.filters.RangedFilter=function(a,b){var c=new Array(a,b);return c.isFiltered=function(a){return a>=this[0]&&a<this[1]},c.filterType="RangedFilter",c},c.filters.TwoDimensionalFilter=function(a){if(null===a)return null;var b=a;return b.isFiltered=function(a){return a.length&&a.length===b.length&&a[0]===b[0]&&a[1]===b[1]},b.filterType="TwoDimensionalFilter",b},c.filters.RangedTwoDimensionalFilter=function(a){if(null===a)return null;var c,b=a;return c=b[0]instanceof Array?[[Math.min(a[0][0],a[1][0]),Math.min(a[0][1],a[1][1])],[Math.max(a[0][0],a[1][0]),Math.max(a[0][1],a[1][1])]]:[[a[0],-(1/0)],[a[1],1/0]],b.isFiltered=function(a){var b,d;return a instanceof Array?(b=a[0],d=a[1]):(b=a,d=c[0][1]),b>=c[0][0]&&b<c[1][0]&&d>=c[0][1]&&d<c[1][1]},b.filterType="RangedTwoDimensionalFilter",b},c.baseMixin=function(d){function M(){i&&i.attr("width",d.width()).attr("height",d.height())}function N(){return i=d.root().append("svg"),M(),i}function O(a){if(!d[a]||!d[a]())throw new c.errors.InvalidStateException("Mandatory attribute chart."+a+" is missing on chart[#"+d.anchorName()+"]")}function T(a){if(d.dimension()&&d.dimension().filter){var b=K(d.dimension(),a);b&&(a=b)}return a}d.__dcFlag__=c.utils.uniqueId();var e,f,g,h,i,j,q,r,w,H,I,k=200,l=function(a){var b=a&&a.getBoundingClientRect&&a.getBoundingClientRect().width;return b&&b>k?b:k},m=l,n=200,o=function(a){var b=a&&a.getBoundingClientRect&&a.getBoundingClientRect().height;return b&&b>n?b:n},p=o,s=c.pluck("key"),t=c.pluck("value"),u=c.pluck("key"),v=c.pluck("key"),x=!1,y=function(a){return d.keyAccessor()(a)+": "+d.valueAccessor()(a)},z=!0,A=!1,B=750,C=0,D=c.printers.filters,E=["dimension","group"],F=c.constants.DEFAULT_CHART_GROUP,G=a.dispatch("preRender","postRender","preRedraw","postRedraw","filtered","zoomed","renderlet","pretransition"),J=[],K=function(a,b){return 0===b.length?a.filter(null):1!==b.length||b[0].isFiltered?1===b.length&&"RangedFilter"===b[0].filterType?a.filterRange(b[0]):a.filterFunction(function(a){for(var c=0;c<b.length;c++){var d=b[c];if(d.isFiltered&&d.isFiltered(a))return!0;if(d<=a&&d>=a)return!0}return!1}):a.filterExact(b[0]),b},L=function(a){return a.all()};d.height=function(b){return arguments.length?(p=a.functor(b||o),r=void 0,d):(c.utils.isNumber(r)||(r=p(h.node())),r)},d.width=function(b){return arguments.length?(m=a.functor(b||l),q=void 0,d):(c.utils.isNumber(q)||(q=m(h.node())),q)},d.minWidth=function(a){return arguments.length?(k=a,d):k},d.minHeight=function(a){return arguments.length?(n=a,d):n},d.dimension=function(a){return arguments.length?(e=a,d.expireCache(),d):e},d.data=function(b){return arguments.length?(L=a.functor(b),d.expireCache(),d):L.call(d,f)},d.group=function(a,b){return arguments.length?(f=a,d._groupName=b,d.expireCache(),d):f},d.ordering=function(a){return arguments.length?(v=a,w=b.quicksort.by(v),d.expireCache(),d):v},d._computeOrderedGroups=function(a){var c=a.slice(0);return c.length<=1?c:(w||(w=b.quicksort.by(v)),w(c,0,c.length))},d.filterAll=function(){return d.filter(null)},d.select=function(a){return h.select(a)},d.selectAll=function(a){return h?h.selectAll(a):null},d.anchor=function(b,e){if(!arguments.length)return g;if(c.instanceOfChart(b))g=b.anchor(),h=b.root(),j=!0;else{if(!b)throw new c.errors.BadArgumentException("parent must be defined");g=b.select&&b.classed?b.node():b,h=a.select(g),h.classed(c.constants.CHART_CLASS,!0),c.registerChart(d,e),j=!1}return F=e,d},d.anchorName=function(){var a=d.anchor();return a&&a.id?a.id:a&&a.replace?a.replace("#",""):"dc-chart"+d.chartID()},d.root=function(a){return arguments.length?(h=a,d):h},d.svg=function(a){return arguments.length?(i=a,d):i},d.resetSvg=function(){return d.select("svg").remove(),N()},d.filterPrinter=function(a){return arguments.length?(D=a,d):D},d.controlsUseVisibility=function(a){return arguments.length?(A=a,d):A},d.turnOnControls=function(){if(h){var a=d.controlsUseVisibility()?"visibility":"display";d.selectAll(".reset").style(a,null),d.selectAll(".filter").text(D(d.filters())).style(a,null)}return d},d.turnOffControls=function(){if(h){var a=d.controlsUseVisibility()?"visibility":"display",b=d.controlsUseVisibility()?"hidden":"none";d.selectAll(".reset").style(a,b),d.selectAll(".filter").style(a,b).text(d.filter())}return d},d.transitionDuration=function(a){return arguments.length?(B=a,d):B},d.transitionDelay=function(a){return arguments.length?(C=a,d):C},d._mandatoryAttributes=function(a){return arguments.length?(E=a,d):E},d.render=function(){r=q=void 0,G.preRender(d),E&&E.forEach(O);var a=d._doRender();return H&&H.render(),d._activateRenderlets("postRender"),a},d._activateRenderlets=function(a){G.pretransition(d),d.transitionDuration()>0&&i?i.transition().duration(d.transitionDuration()).delay(d.transitionDelay()).each("end",function(){G.renderlet(d),a&&G[a](d)}):(G.renderlet(d),a&&G[a](d))},d.redraw=function(){M(),G.preRedraw(d);var a=d._doRedraw();return H&&H.render(),d._activateRenderlets("postRedraw"),a},d.commitHandler=function(a){return arguments.length?(I=a,d):I},d.redrawGroup=function(){return I?I(!1,function(a,b){a?console.log(a):c.redrawAll(d.chartGroup())}):c.redrawAll(d.chartGroup()),d},d.renderGroup=function(){return I?I(!1,function(a,b){a?console.log(a):c.renderAll(d.chartGroup())}):c.renderAll(d.chartGroup()),d},d._invokeFilteredListener=function(a){void 0!==a&&G.filtered(d,a)},d._invokeZoomedListener=function(){G.zoomed(d)};var P=function(a,b){return null===b||"undefined"==typeof b?a.length>0:a.some(function(a){return b<=a&&b>=a})};d.hasFilterHandler=function(a){return arguments.length?(P=a,d):P},d.hasFilter=function(a){return P(J,a)};var Q=function(a,b){for(var c=0;c<a.length;c++)if(a[c]<=b&&a[c]>=b){a.splice(c,1);break}return a};d.removeFilterHandler=function(a){return arguments.length?(Q=a,d):Q};var R=function(a,b){return a.push(b),a};d.addFilterHandler=function(a){return arguments.length?(R=a,d):R};var S=function(a){return[]};return d.resetFilterHandler=function(a){return arguments.length?(S=a,d):S},d.replaceFilter=function(a){J=S(J),d.filter(a)},d.filter=function(a){if(!arguments.length)return J.length>0?J[0]:null;var b=J;return a instanceof Array&&a[0]instanceof Array&&!a.isFiltered?a[0].forEach(function(a){b=P(b,a)?Q(b,a):R(b,a)}):b=null===a?S(b):P(b,a)?Q(b,a):R(b,a),J=T(b),d._invokeFilteredListener(a),null!==h&&d.hasFilter()?d.turnOnControls():d.turnOffControls(),d},d.filters=function(){return J},d.highlightSelected=function(b){a.select(b).classed(c.constants.SELECTED_CLASS,!0),a.select(b).classed(c.constants.DESELECTED_CLASS,!1)},d.fadeDeselected=function(b){a.select(b).classed(c.constants.SELECTED_CLASS,!1),a.select(b).classed(c.constants.DESELECTED_CLASS,!0)},d.resetHighlight=function(b){a.select(b).classed(c.constants.SELECTED_CLASS,!1),a.select(b).classed(c.constants.DESELECTED_CLASS,!1)},d.onClick=function(a){var b=d.keyAccessor()(a);c.events.trigger(function(){d.filter(b),d.redrawGroup()})},d.filterHandler=function(a){return arguments.length?(K=a,d):K},d._doRender=function(){return d},d._doRedraw=function(){return d},d.legendables=function(){return[]},d.legendHighlight=function(){},d.legendReset=function(){},d.legendToggle=function(){},d.isLegendableHidden=function(){return!1},d.keyAccessor=function(a){return arguments.length?(s=a,d):s},d.valueAccessor=function(a){return arguments.length?(t=a,d):t},d.label=function(a,b){return arguments.length?(u=a,(void 0===b||b)&&(x=!0),d):u},d.renderLabel=function(a){return arguments.length?(x=a,d):x},d.title=function(a){return arguments.length?(y=a,d):y},d.renderTitle=function(a){return arguments.length?(z=a,d):z},d.renderlet=c.logger.deprecate(function(a){return d.on("renderlet."+c.utils.uniqueId(),a),d},'chart.renderlet has been deprecated.  Please use chart.on("renderlet.<renderletKey>", renderletFunction)'),d.chartGroup=function(a){return arguments.length?(j||c.deregisterChart(d,F),F=a,j||c.registerChart(d,F),d):F},d.expireCache=function(){return d},d.legend=function(a){return arguments.length?(H=a,H.parent(d),d):H},d.chartID=function(){return d.__dcFlag__},d.options=function(a){var b=["anchor","group","xAxisLabel","yAxisLabel","stack","title","point","getColor","overlayGeoJson"];for(var e in a)"function"==typeof d[e]?a[e]instanceof Array&&b.indexOf(e)!==-1?d[e].apply(d,a[e]):d[e].call(d,a[e]):c.logger.debug("Not a valid option setter name: "+e);return d},d.on=function(a,b){return G.on(a,b),d},d},c.marginMixin=function(a){var b={top:10,right:50,bottom:30,left:30};return a.margins=function(c){return arguments.length?(b=c,a):b},a.effectiveWidth=function(){return a.width()-a.margins().left-a.margins().right},a.effectiveHeight=function(){return a.height()-a.margins().top-a.margins().bottom},a},c.colorMixin=function(b){var d=a.scale.category20c(),e=!0,f=function(a){return b.keyAccessor()(a)};return b.colors=function(c){return arguments.length?(d=c instanceof Array?a.scale.quantize().range(c):a.functor(c),b):d},b.ordinalColors=function(c){return b.colors(a.scale.ordinal().range(c))},b.linearColors=function(c){return b.colors(a.scale.linear().range(c).interpolate(a.interpolateHcl))},b.colorAccessor=function(a){return arguments.length?(f=a,e=!1,b):f},b.defaultColorAccessor=function(){return e},b.colorDomain=function(a){return arguments.length?(d.domain(a),b):d.domain()},b.calculateColorDomain=function(){var c=[a.min(b.data(),b.colorAccessor()),a.max(b.data(),b.colorAccessor())];return d.domain(c),b},b.getColor=function(a,b){return d(f.call(this,a,b))},b.colorCalculator=c.logger.deprecate(function(a){return arguments.length?(b.getColor=a,b):b.getColor},"colorMixin.colorCalculator has been deprecated. Please colorMixin.colors and colorMixin.colorAccessor instead"),b},c.coordinateGridMixin=function(b){function W(a,b){return!a||!b||a.length!==b.length||a.some(function(a,c){return a&&b[c]?a.toString()!==b[c].toString():a===b[c]})}function X(a,c){b.isOrdinal()?(b.elasticX()||0===m.domain().length)&&m.domain(b._ordinalXDomain()):b.elasticX()&&m.domain([b.xAxisMin(),b.xAxisMax()]);var d=m.domain();(c||W(v,d))&&b.rescale(),v=d,b.isOrdinal()?m.rangeBands([0,b.xAxisLength()],U,b._useOuterPadding()?T:0):m.range([0,b.xAxisLength()]),o=o.scale(b.x()),Y(a)}function Y(a){var e=a.select("g."+f);if(G){e.empty()&&(e=a.insert("g",":first-child").attr("class",d+" "+f).attr("transform","translate("+b.margins().left+","+b.margins().top+")"));var g=o.tickValues()?o.tickValues():"function"==typeof m.ticks?m.ticks(o.ticks()[0]):m.domain(),h=e.selectAll("line").data(g),i=h.enter().append("line").attr("x1",function(a){return m(a)}).attr("y1",b._xAxisY()-b.margins().top).attr("x2",function(a){return m(a)}).attr("y2",0).attr("opacity",0);c.transition(i,b.transitionDuration(),b.transitionDelay()).attr("opacity",1),c.transition(h,b.transitionDuration(),b.transitionDelay()).attr("x1",function(a){return m(a)}).attr("y1",b._xAxisY()-b.margins().top).attr("x2",function(a){return m(a)}).attr("y2",0),h.exit().remove()}else e.selectAll("line").remove()}function Z(){return b._xAxisY()-b.margins().top}function $(){return b.anchorName().replace(/[ .#=\[\]]/g,"-")+"-clip"}function _(){var a=c.utils.appendOrSelect(j,"defs"),d=$(),e=c.utils.appendOrSelect(a,"#"+d,"clipPath").attr("id",d),f=2*S;c.utils.appendOrSelect(e,"rect").attr("width",b.xAxisLength()+f).attr("height",b.yAxisHeight()+f).attr("transform","translate(-"+S+", -"+S+")")}function aa(a){b.isOrdinal()&&(D=!1),X(b.g(),a),b._prepareYAxis(b.g()),b.plotData(),(b.elasticX()||I||a)&&b.renderXAxis(b.g()),(b.elasticY()||I||a)&&b.renderYAxis(b.g()),a?b.renderBrush(b.g(),!1):b.redrawBrush(b.g(),I),b.fadeDeselectedArea(),I=!1}function ba(){R?b._enableMouseZoom():O&&b._disableMouseZoom()}function ca(){if(H=!0,L){var a=n;P&&(a=da(a,P.x().domain()));var d=ea(b.x().domain(),a);d&&b.x().domain(d)}var e=b.x().domain(),f=c.filters.RangedFilter(e[0],e[1]);b.replaceFilter(f),b.rescale(),b.redraw(),P&&!fa(b.filter(),P.filter())&&c.events.trigger(function(){P.replaceFilter(f),P.redraw()}),b._invokeZoomedListener(),c.events.trigger(function(){b.redrawGroup()},c.constants.EVENT_DELAY),H=!fa(e,n)}function da(a,b){return(a[0]>b[1]||a[1]<b[0])&&console.warn("could not intersect extents"),[Math.max(a[0],b[0]),Math.min(a[1],b[1])]}function ea(a,b){var d=a[1]-a[0];return a[0]<b[0]?[b[0],Math.min(b[1],c.utils.add(b[0],d,"millis"))]:a[1]>b[1]?[Math.max(b[0],c.utils.subtract(b[1],d,"millis")),b[1]]:null}function fa(a,b){return!a&&!b||!(!a||!b)&&(0===a.length&&0===b.length||a[0].valueOf()===b[0].valueOf()&&a[1].valueOf()===b[1].valueOf())}function ga(a){return a instanceof Array&&a.length>1}var d="grid-line",e="horizontal",f="vertical",g="y-axis-label",h="x-axis-label",i=12;b=c.colorMixin(c.marginMixin(c.baseMixin(b))),b.colors(a.scale.category10()),b._mandatoryAttributes().push("x");var j,k,l,m,n,t,v,w,A,E,J,P,Q,o=a.svg.axis().orient("bottom"),p=c.units.integers,q=0,r="day",s=!1,u=0,x=a.svg.axis().orient("left"),y=0,z=!1,B=0,C=a.svg.brush(),D=!0,F=!1,G=!1,H=!1,I=!1,K=[1,1/0],L=!0,M=a.behavior.zoom().on("zoom",ca),N=a.behavior.zoom().on("zoom",null),O=!1,R=!1,S=0,T=.5,U=0,V=!1;return b.rescale=function(){return J=void 0,I=!0,b},b.resizing=function(){return I},b.rangeChart=function(a){return arguments.length?(P=a,P.focusChart(b),b):P},b.zoomScale=function(a){return arguments.length?(K=a,b):K},b.zoomOutRestrict=function(a){return arguments.length?(K[0]=a?1:0,L=a,b):L},b._generateG=function(a){j=void 0===a?b.svg():a;var c=window.location.href.split("#")[0];return k=j.append("g"),l=k.append("g").attr("class","chart-body").attr("transform","translate("+b.margins().left+", "+b.margins().top+")").attr("clip-path","url("+c+"#"+$()+")"),k},b.g=function(a){return arguments.length?(k=a,b):k},b.mouseZoomable=function(a){return arguments.length?(R=a,b):R},b.chartBodyG=function(a){return arguments.length?(l=a,b):l},b.x=function(a){return arguments.length?(m=a,n=m.domain(),b.rescale(),b):m},b.xOriginalDomain=function(){return n},b.xUnits=function(a){return arguments.length?(p=a,b):p},b.xAxis=function(a){return arguments.length?(o=a,b):o},b.elasticX=function(a){return arguments.length?(s=a,b):s},b.xAxisPadding=function(a){return arguments.length?(q=a,b):q},b.xAxisPaddingUnit=function(a){return arguments.length?(r=a,b):r},b.xUnitCount=function(){if(void 0===J){var a=b.xUnits()(b.x().domain()[0],b.x().domain()[1],b.x().domain());J=a instanceof Array?a.length:a}return J},b.useRightYAxis=function(a){return arguments.length?(V=a,b):V},b.isOrdinal=function(){return b.xUnits()===c.units.ordinal},b._useOuterPadding=function(){return!0},b._ordinalXDomain=function(){var a=b._computeOrderedGroups(b.data());return a.map(b.keyAccessor())},b.renderXAxis=function(a){var d=a.select("g.x");d.empty()&&(d=a.append("g").attr("class","axis x").attr("transform","translate("+b.margins().left+","+b._xAxisY()+")"));var e=a.select("text."+h);e.empty()&&b.xAxisLabel()&&(e=a.append("text").attr("class",h).attr("transform","translate("+(b.margins().left+b.xAxisLength()/2)+","+(b.height()-u)+")").attr("text-anchor","middle")),b.xAxisLabel()&&e.text()!==b.xAxisLabel()&&e.text(b.xAxisLabel()),c.transition(d,b.transitionDuration(),b.transitionDelay()).attr("transform","translate("+b.margins().left+","+b._xAxisY()+")").call(o),c.transition(e,b.transitionDuration(),b.transitionDelay()).attr("transform","translate("+(b.margins().left+b.xAxisLength()/2)+","+(b.height()-u)+")")},b._xAxisY=function(){return b.height()-b.margins().bottom},b.xAxisLength=function(){return b.effectiveWidth()},b.xAxisLabel=function(a,c){return arguments.length?(t=a,b.margins().bottom-=u,u=void 0===c?i:c,b.margins().bottom+=u,b):t},b._prepareYAxis=function(c){if(void 0===w||b.elasticY()){void 0===w&&(w=a.scale.linear());var d=b.yAxisMin()||0,e=b.yAxisMax()||0;w.domain([d,e]).rangeRound([b.yAxisHeight(),0])}w.range([b.yAxisHeight(),0]),x=x.scale(w),V&&x.orient("right"),b._renderHorizontalGridLinesForAxis(c,w,x)},b.renderYAxisLabel=function(a,d,e,f){f=f||B;var h=b.g().select("text."+g+"."+a+"-label"),i=b.margins().top+b.yAxisHeight()/2;h.empty()&&d&&(h=b.g().append("text").attr("transform","translate("+f+","+i+"),rotate("+e+")").attr("class",g+" "+a+"-label").attr("text-anchor","middle").text(d)),d&&h.text()!==d&&h.text(d),c.transition(h,b.transitionDuration(),b.transitionDelay()).attr("transform","translate("+f+","+i+"),rotate("+e+")")},b.renderYAxisAt=function(a,d,e){var f=b.g().select("g."+a);f.empty()&&(f=b.g().append("g").attr("class","axis "+a).attr("transform","translate("+e+","+b.margins().top+")")),c.transition(f,b.transitionDuration(),b.transitionDelay()).attr("transform","translate("+e+","+b.margins().top+")").call(d)},b.renderYAxis=function(){var a=V?b.width()-b.margins().right:b._yAxisX();b.renderYAxisAt("y",x,a);var c=V?b.width()-B:B,d=V?90:-90;b.renderYAxisLabel("y",b.yAxisLabel(),d,c)},b._renderHorizontalGridLinesForAxis=function(a,f,g){var h=a.select("g."+e);if(F){var i=g.tickValues()?g.tickValues():f.ticks(g.ticks()[0]);h.empty()&&(h=a.insert("g",":first-child").attr("class",d+" "+e).attr("transform","translate("+b.margins().left+","+b.margins().top+")"));var j=h.selectAll("line").data(i),k=j.enter().append("line").attr("x1",1).attr("y1",function(a){return f(a)}).attr("x2",b.xAxisLength()).attr("y2",function(a){return f(a)}).attr("opacity",0);c.transition(k,b.transitionDuration(),b.transitionDelay()).attr("opacity",1),c.transition(j,b.transitionDuration(),b.transitionDelay()).attr("x1",1).attr("y1",function(a){return f(a)}).attr("x2",b.xAxisLength()).attr("y2",function(a){return f(a)}),j.exit().remove()}else h.selectAll("line").remove()},b._yAxisX=function(){return b.useRightYAxis()?b.width()-b.margins().right:b.margins().left},b.yAxisLabel=function(a,c){return arguments.length?(A=a,b.margins().left-=B,B=void 0===c?i:c,b.margins().left+=B,b):A},b.y=function(a){return arguments.length?(w=a,b.rescale(),b):w},b.yAxis=function(a){return arguments.length?(x=a,b):x},b.elasticY=function(a){return arguments.length?(z=a,b):z},b.renderHorizontalGridLines=function(a){return arguments.length?(F=a,b):F},b.renderVerticalGridLines=function(a){return arguments.length?(G=a,b):G},b.xAxisMin=function(){var d=a.min(b.data(),function(a){return b.keyAccessor()(a)});return c.utils.subtract(d,q,r)},b.xAxisMax=function(){var d=a.max(b.data(),function(a){return b.keyAccessor()(a)});return c.utils.add(d,q,r)},b.yAxisMin=function(){var d=a.min(b.data(),function(a){return b.valueAccessor()(a)});return c.utils.subtract(d,y)},b.yAxisMax=function(){var d=a.max(b.data(),function(a){return b.valueAccessor()(a)});return c.utils.add(d,y)},b.yAxisPadding=function(a){return arguments.length?(y=a,b):y},b.yAxisHeight=function(){return b.effectiveHeight()},b.round=function(a){return arguments.length?(E=a,b):E},b._rangeBandPadding=function(a){return arguments.length?(U=a,b):U},b._outerRangeBandPadding=function(a){return arguments.length?(T=a,b):T},c.override(b,"filter",function(a){return arguments.length?(b._filter(a),a?b.brush().extent(a):b.brush().clear(),b):b._filter()}),b.brush=function(a){return arguments.length?(C=a,b):C},b.renderBrush=function(a){if(D){C.on("brush",b._brushing),C.on("brushstart",b._disableMouseZoom),C.on("brushend",ba);var c=a.append("g").attr("class","brush").attr("transform","translate("+b.margins().left+","+b.margins().top+")").call(C.x(b.x()));b.setBrushY(c,!1),b.setHandlePaths(c),b.hasFilter()&&b.redrawBrush(a,!1)}},b.setHandlePaths=function(a){a.selectAll(".resize").append("path").attr("d",b.resizeHandlePath)},b.setBrushY=function(a){a.selectAll("rect").attr("height",Z()),a.selectAll(".resize path").attr("d",b.resizeHandlePath)},b.extendBrush=function(){var a=C.extent();return b.round()&&(a[0]=a.map(b.round())[0],a[1]=a.map(b.round())[1],k.select(".brush").call(C.extent(a))),a},b.brushIsEmpty=function(a){return C.empty()||!a||a[1]<=a[0]},b._brushing=function(){var a=b.extendBrush();if(b.redrawBrush(k,!1),b.brushIsEmpty(a))c.events.trigger(function(){b.filter(null),b.redrawGroup()},c.constants.EVENT_DELAY);else{var d=c.filters.RangedFilter(a[0],a[1]);c.events.trigger(function(){b.replaceFilter(d),b.redrawGroup()},c.constants.EVENT_DELAY)}},b.redrawBrush=function(a,d){if(D){b.filter()&&b.brush().empty()&&b.brush().extent(b.filter());var e=c.optionalTransition(d,b.transitionDuration(),b.transitionDelay())(a.select("g.brush"));b.setBrushY(e),e.call(b.brush().x(b.x()).extent(b.brush().extent()))}b.fadeDeselectedArea()},b.fadeDeselectedArea=function(){},b.resizeHandlePath=function(a){var b=+("e"===a),c=b?1:-1,d=Z()/3;return"M"+.5*c+","+d+"A6,6 0 0 "+b+" "+6.5*c+","+(d+6)+"V"+(2*d-6)+"A6,6 0 0 "+b+" "+.5*c+","+2*d+"ZM"+2.5*c+","+(d+8)+"V"+(2*d-8)+"M"+4.5*c+","+(d+8)+"V"+(2*d-8)},b.clipPadding=function(a){return arguments.length?(S=a,b):S},b._preprocessData=function(){},b._doRender=function(){return b.resetSvg(),b._preprocessData(),b._generateG(),_(),aa(!0),ba(),b},b._doRedraw=function(){return b._preprocessData(),aa(!1),_(),b},b._enableMouseZoom=function(){O=!0,M.x(b.x()).scaleExtent(K).size([b.width(),b.height()]).duration(b.transitionDuration()),b.root().call(M)},b._disableMouseZoom=function(){b.root().call(N)},b.focus=function(a){ga(a)?b.x().domain(a):b.x().domain(n),M.x(b.x()),ca()},b.refocused=function(){return H},b.focusChart=function(a){return arguments.length?(Q=a,b.on("filtered",function(a){a.filter()?fa(a.filter(),Q.filter())||c.events.trigger(function(){Q.focus(a.filter())}):c.events.trigger(function(){Q.x().domain(Q.xOriginalDomain())})}),b):Q},b.brushOn=function(a){return arguments.length?(D=a,b):D},b},c.stackMixin=function(b){function d(a,c){var d=a.accessor||b.valueAccessor();return a.name=String(a.name||c),a.values=a.group.all().map(function(c,e){return{x:b.keyAccessor()(c,e),y:a.hidden?null:d(c,e),data:c,layer:a.name,hidden:a.hidden}}),a.values=a.values.filter(i()),a.values}function i(){if(!b.x())return a.functor(!0);var c=b.x().domain();return b.isOrdinal()?function(){return!0}:b.elasticX()?function(){return!0}:function(a){return a.x>=c[0]&&a.x<=c[c.length-1]}}function j(a){var b=f.map(c.pluck("name")).indexOf(a);return f[b]}function k(){var a=b.data().map(function(a){return a.values});return Array.prototype.concat.apply([],a)}function l(a){return!a.hidden}var e=a.layout.stack().values(d),f=[],g={},h=!1;return b.stack=function(a,c,d){if(!arguments.length)return f;arguments.length<=2&&(d=c);var e={group:a};return"string"==typeof c&&(e.name=c),"function"==typeof d&&(e.accessor=d),f.push(e),b},c.override(b,"group",function(a,c,d){return arguments.length?(f=[],g={},b.stack(a,c),d&&b.valueAccessor(d),b._group(a,c)):b._group()}),b.hidableStacks=function(a){return arguments.length?(h=a,b):h},b.hideStack=function(a){var c=j(a);return c&&(c.hidden=!0),b},b.showStack=function(a){var c=j(a);return c&&(c.hidden=!1),b},b.getValueAccessorByIndex=function(a){return f[a].accessor||b.valueAccessor()},b.yAxisMin=function(){var d=a.min(k(),function(a){return a.y<0?a.y+a.y0:a.y0});return c.utils.subtract(d,b.yAxisPadding())},b.yAxisMax=function(){var d=a.max(k(),function(a){return a.y>0?a.y+a.y0:a.y0});return c.utils.add(d,b.yAxisPadding())},b.xAxisMin=function(){var d=a.min(k(),c.pluck("x"));return c.utils.subtract(d,b.xAxisPadding(),b.xAxisPaddingUnit())},b.xAxisMax=function(){var d=a.max(k(),c.pluck("x"));return c.utils.add(d,b.xAxisPadding(),b.xAxisPaddingUnit())},c.override(b,"title",function(a,c){return a?"function"==typeof a?b._title(a):a===b._groupName&&"function"==typeof c?b._title(c):"function"!=typeof c?g[a]||b._title():(g[a]=c,b):b._title()}),b.stackLayout=function(c){return arguments.length?(e=c,e.values()===a.layout.stack().values()&&e.values(d),b):e},b.data(function(){var a=f.filter(l);return a.length?b.stackLayout()(a):[]}),b._ordinalXDomain=function(){var a=k().map(c.pluck("data")),d=b._computeOrderedGroups(a);return d.map(b.keyAccessor())},b.colorAccessor(function(a){var b=this.layer||this.name||a.name||a.layer;return b}),b.legendables=function(){return f.map(function(a,c){return{chart:b,name:a.name,hidden:a.hidden||!1,color:b.getColor.call(a,a.values,c)}})},b.isLegendableHidden=function(a){var b=j(a.name);return!!b&&b.hidden},b.legendToggle=function(a){h&&(b.isLegendableHidden(a)?b.showStack(a.name):b.hideStack(a.name),b.renderGroup())},b},c.capMixin=function(b){var d=1/0,e="Others",f=function(c){var d=a.sum(c,b.valueAccessor()),e=b.group().all(),f=a.sum(e,b.valueAccessor()),g=c.map(b.keyAccessor()),h=e.map(b.keyAccessor()),i=a.set(g),j=h.filter(function(a){return!i.has(a)});return f>d?c.concat([{others:j,key:b.othersLabel(),value:f-d}]):c};return b.cappedKeyAccessor=function(a,c){return a.others?a.key:b.keyAccessor()(a,c)},b.cappedValueAccessor=function(a,c){return a.others?a.value:b.valueAccessor()(a,c)},b.data(function(a){if(d===1/0)return b._computeOrderedGroups(a.all());var c=a.top(d);return c=b._computeOrderedGroups(c),f?f(c):c}),b.cap=function(a){return arguments.length?(d=a,b):d},b.othersLabel=function(a){return arguments.length?(e=a,b):e},b.othersGrouper=function(a){return arguments.length?(f=a,b):f},c.override(b,"onClick",function(a){a.others&&b.filter([a.others]),b._onClick(a)}),b},c.bubbleMixin=function(b){var d=.3,e=10;b.BUBBLE_NODE_CLASS="node",b.BUBBLE_CLASS="bubble",b.MIN_RADIUS=10,b=c.colorMixin(b),b.renderLabel(!0),b.data(function(a){return a.top(1/0)});var f=a.scale.linear().domain([0,100]),g=function(a){return a.r};b.r=function(a){return arguments.length?(f=a,b):f},b.radiusValueAccessor=function(a){return arguments.length?(g=a,b):g},b.rMin=function(){var c=a.min(b.data(),function(a){return b.radiusValueAccessor()(a)});return c},b.rMax=function(){var c=a.max(b.data(),function(a){return b.radiusValueAccessor()(a)});return c},b.bubbleR=function(a){var c=b.radiusValueAccessor()(a),d=b.r()(c);return(isNaN(d)||c<=0)&&(d=0),d};var h=function(a){return b.label()(a)},i=function(a){return b.bubbleR(a)>e},j=function(a){return i(a)?1:0},k=function(a){return i(a)?"all":"none"};b._doRenderLabel=function(a){if(b.renderLabel()){var d=a.select("text");d.empty()&&(d=a.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",b.onClick)),
d.attr("opacity",0).attr("pointer-events",k).text(h),c.transition(d,b.transitionDuration(),b.transitionDelay()).attr("opacity",j)}},b.doUpdateLabels=function(a){if(b.renderLabel()){var d=a.select("text").attr("pointer-events",k).text(h);c.transition(d,b.transitionDuration(),b.transitionDelay()).attr("opacity",j)}};var l=function(a){return b.title()(a)};return b._doRenderTitles=function(a){if(b.renderTitle()){var c=a.select("title");c.empty()&&a.append("title").text(l)}},b.doUpdateTitles=function(a){b.renderTitle()&&a.select("title").text(l)},b.minRadius=function(a){return arguments.length?(b.MIN_RADIUS=a,b):b.MIN_RADIUS},b.minRadiusWithLabel=function(a){return arguments.length?(e=a,b):e},b.maxBubbleRelativeSize=function(a){return arguments.length?(d=a,b):d},b.fadeDeselectedArea=function(){b.hasFilter()?b.selectAll("g."+b.BUBBLE_NODE_CLASS).each(function(a){b.isSelectedNode(a)?b.highlightSelected(this):b.fadeDeselected(this)}):b.selectAll("g."+b.BUBBLE_NODE_CLASS).each(function(){b.resetHighlight(this)})},b.isSelectedNode=function(a){return b.hasFilter(a.key)},b.onClick=function(a){var d=a.key;c.events.trigger(function(){b.filter(d),b.redrawGroup()})},b},c.pieChart=function(b,d){function w(){l=m?m:a.min([v.width(),v.height()])/2;var e,b=L(),d=N();if(a.sum(v.data(),v.valueAccessor())?(e=d(v.data()),p.classed(j,!1)):(e=d([{key:k,value:1,others:[k]}]),p.classed(j,!0)),p){var n=p.select("g."+h).selectAll("g."+f).data(e),o=p.select("g."+i).selectAll("text."+g).data(e);x(n,o,b,e),F(e,b),J(n,o),K(),c.transition(p,v.transitionDuration(),v.transitionDelay()).attr("transform","translate("+v.cx()+","+v.cy()+")")}}function x(a,b,c,d){var e=y(a);z(e,c),A(e),D(b,d,c)}function y(a){var b=a.enter().append("g").attr("class",function(a,b){return f+" _"+b});return b}function z(a,b){var d=a.append("path").attr("fill",S).on("click",T).attr("d",function(a,c){return U(a,c,b)}),e=c.transition(d,v.transitionDuration(),v.transitionDelay());e.attrTween&&e.attrTween("d",Q)}function A(a){v.renderTitle()&&a.append("title").text(function(a){return v.title()(a.data)})}function B(a,b){v._applyLabelText(a),c.transition(a,v.transitionDuration(),v.transitionDelay()).attr("transform",function(a){return V(a,b)}).attr("text-anchor","middle")}function C(a,b){v.select("g.pie-slice._"+a).classed("highlight",b)}function D(a,b,c){if(v.renderLabel()){var d=a.enter().append("text").attr("class",function(a,b){var c=f+" "+g+" _"+b;return t&&(c+=" external"),c}).on("click",T).on("mouseover",function(a,b){C(b,!0)}).on("mouseout",function(a,b){C(b,!1)});B(d,c),t&&u&&E(b,c)}}function E(b,d){var e=p.selectAll("polyline."+f).data(b);e.enter().append("polyline").attr("class",function(a,b){return"pie-path _"+b+" "+f}).on("click",T).on("mouseover",function(a,b){C(b,!0)}).on("mouseout",function(a,b){C(b,!1)}),e.exit().remove();var g=a.svg.arc().outerRadius(l-o+t).innerRadius(l-o),h=c.transition(e,v.transitionDuration(),v.transitionDelay());h.attrTween?h.attrTween("points",function(b){var c=this._current||b;c={startAngle:c.startAngle,endAngle:c.endAngle};var e=a.interpolate(c,b);return this._current=e(0),function(a){var b=e(a);return[d.centroid(b),g.centroid(b)]}}):h.attr("points",function(a){return[d.centroid(a),g.centroid(a)]}),h.style("visibility",function(a){return a.endAngle-a.startAngle<1e-4?"hidden":"visible"})}function F(a,b){G(a,b),H(a,b),I(a)}function G(a,b){var d=p.selectAll("g."+f).data(a).select("path").attr("d",function(a,c){return U(a,c,b)}),e=c.transition(d,v.transitionDuration(),v.transitionDelay());e.attrTween&&e.attrTween("d",Q),e.attr("fill",S)}function H(a,b){if(v.renderLabel()){var c=p.selectAll("text."+g).data(a);B(c,b),t&&u&&E(a,b)}}function I(a){v.renderTitle()&&p.selectAll("g."+f).data(a).select("title").text(function(a){return v.title()(a.data)})}function J(a,b){a.exit().remove(),b.exit().remove()}function K(){v.hasFilter()?v.selectAll("g."+f).each(function(a){M(a)?v.highlightSelected(this):v.fadeDeselected(this)}):v.selectAll("g."+f).each(function(){v.resetHighlight(this)})}function L(){return a.svg.arc().outerRadius(l-o).innerRadius(n)}function M(a){return v.hasFilter(v.cappedKeyAccessor(a.data))}function N(){return a.layout.pie().sort(null).value(v.cappedValueAccessor)}function O(a){var b=a.endAngle-a.startAngle;return isNaN(b)||b<s}function P(a){return 0===v.cappedValueAccessor(a)}function Q(b){b.innerRadius=n;var c=this._current;c=R(c)?{startAngle:0,endAngle:0}:{startAngle:c.startAngle,endAngle:c.endAngle};var d=a.interpolate(c,b);return this._current=d(0),function(a){return U(d(a),0,L())}}function R(a){return!a||isNaN(a.startAngle)||isNaN(a.endAngle)}function S(a,b){return v.getColor(a.data,b)}function T(a,b){p.attr("class")!==j&&v.onClick(a.data,b)}function U(a,b,c){var d=c(a,b);return d.indexOf("NaN")>=0&&(d="M0,0"),d}function V(b,c){var d;return d=t?a.svg.arc().outerRadius(l-o+t).innerRadius(l-o+t).centroid(b):c.centroid(b),isNaN(d[0])||isNaN(d[1])?"translate(0,0)":"translate("+d+")"}function W(b,c){v.selectAll("g.pie-slice").each(function(d){b.name===d.data.key&&a.select(this).classed("highlight",c)})}var l,m,p,q,r,t,e=.5,f="pie-slice",g="pie-label",h="pie-slice-group",i="pie-label-group",j="empty-chart",k="empty",n=0,o=0,s=e,u=!1,v=c.capMixin(c.colorMixin(c.baseMixin({})));return v.colorAccessor(v.cappedKeyAccessor),v.title(function(a){return v.cappedKeyAccessor(a)+": "+v.cappedValueAccessor(a)}),v.slicesCap=v.cap,v.label(v.cappedKeyAccessor),v.renderLabel(!0),v.transitionDuration(350),v.transitionDelay(0),v._doRender=function(){return v.resetSvg(),p=v.svg().append("g").attr("transform","translate("+v.cx()+","+v.cy()+")"),p.append("g").attr("class",h),p.append("g").attr("class",i),w(),v},v._applyLabelText=function(a){a.text(function(a){var b=a.data;return!P(b)&&!O(a)||M(a)?v.label()(a.data):""})},v.externalRadiusPadding=function(a){return arguments.length?(o=a,v):o},v.innerRadius=function(a){return arguments.length?(n=a,v):n},v.radius=function(a){return arguments.length?(m=a,v):m},v.cx=function(a){return arguments.length?(q=a,v):q||v.width()/2},v.cy=function(a){return arguments.length?(r=a,v):r||v.height()/2},v._doRedraw=function(){return w(),v},v.minAngleForLabel=function(a){return arguments.length?(s=a,v):s},v.emptyTitle=function(a){return 0===arguments.length?k:(k=a,v)},v.externalLabels=function(a){return 0===arguments.length?t:(t=a?a:void 0,v)},v.drawPaths=function(a){return 0===arguments.length?u:(u=a,v)},v.legendables=function(){return v.data().map(function(a,b){var c={name:a.key,data:a.value,others:a.others,chart:v};return c.color=v.getColor(a,b),c})},v.legendHighlight=function(a){W(a,!0)},v.legendReset=function(a){W(a,!1)},v.legendToggle=function(a){v.onClick({key:a.name,others:a.others})},v.anchor(b,d)},c.barChart=function(b,d){function p(a){return c.utils.safeNumber(Math.abs(i.y()(a.y+a.y0)-i.y()(a.y0)))}function q(a,b,d){var e=a.selectAll("text.barLabel").data(d.values,c.pluck("x"));e.enter().append("text").attr("class","barLabel").attr("text-anchor","middle"),i.isOrdinal()&&(e.on("click",i.onClick),e.attr("cursor","pointer")),c.transition(e,i.transitionDuration(),i.transitionDelay()).attr("x",function(a){var d=i.x()(a.x);return l&&(d+=i.groupGap()/2,d+=b*(o+j),d+=j/2),d+=o/2,m&&!i.isOrdinal()&&(d-=l?((o+j)*i.stack().length+i.groupGap())/2:o/2),c.utils.safeNumber(d)}).attr("y",function(a){var b=i.y()(a.y+a.y0);return a.y<0&&(b-=p(a)),c.utils.safeNumber(b-h)}).text(function(a){return i.label()(a)}),c.transition(e.exit(),i.transitionDuration(),i.transitionDelay()).attr("height",0).remove()}function r(a,b,d){var e=a.selectAll("rect.bar").data(d.values,c.pluck("x")),f=e.enter().append("rect").attr("class","bar").attr("fill",c.pluck("data",i.getColor)).attr("y",i.yAxisHeight()).attr("height",0);i.renderTitle()&&f.append("title").text(c.pluck("data",i.title(d.name))),i.isOrdinal()&&e.on("click",i.onClick),c.transition(e,i.transitionDuration(),i.transitionDelay()).attr("x",function(a){var d=i.x()(a.x);return l&&(d+=i.groupGap()/2,d+=b*(o+j),d+=j/2),m&&!i.isOrdinal()&&(d-=l?((o+j)*i.stack().length+i.groupGap())/2:o/2),i.isOrdinal()&&void 0!==j&&(d+=j/2),c.utils.safeNumber(d)}).attr("y",function(a){var b=i.y()(a.y+a.y0);return a.y<0&&(b-=p(a)),c.utils.safeNumber(b)}).attr("width",o).attr("height",function(a){return p(a)}).attr("fill",c.pluck("data",i.getColor)).select("title").text(c.pluck("data",i.title(d.name))),c.transition(e.exit(),i.transitionDuration(),i.transitionDelay()).attr("x",function(a){return i.x()(a.x)}).attr("width",.9*o).remove()}function s(){if(void 0===o){var a=i.xUnitCount();if(l){var b=i.stack().length;o=i.isOrdinal()?Math.floor((i.x().rangeBand()-i.groupGap())/b-j):Math.floor((i.xAxisLength()-(i.xUnitCount()-1)*i.groupGap()-b*j)/(a*b))}else o=i.isOrdinal()&&void 0===j?Math.floor(i.x().rangeBand()):j?Math.floor((i.xAxisLength()-(a-1)*j)/a):Math.floor(i.xAxisLength()/(1+i.barPadding())/a);(o===1/0||isNaN(o)||o<e)&&(o=e)}}function t(b,c){return function(){var d=a.select(this),e=d.attr("fill")===b;return c?!e:e}}var o,e=1,f=2,g=5,h=3,i=c.stackMixin(c.coordinateGridMixin({})),j=f,k=g,l=!1,m=!1,n=!1;return c.override(i,"rescale",function(){return i._rescale(),o=void 0,i}),c.override(i,"render",function(){return i.round()&&m&&!n&&c.logger.warn("By default, brush rounding is disabled if bars are centered. See dc.js bar chart API documentation for details."),i._render()}),i.label(function(a){return c.utils.printSingleValue(a.y0+a.y)},!1),i.plotData=function(){var b=i.chartBodyG().selectAll("g.stack").data(i.data());s(),b.enter().append("g").attr("class",function(a,b){return"stack _"+b});var c=b.size()-1;b.each(function(b,d){var e=a.select(this);r(e,d,b),i.renderLabel()&&(l||c===d)&&q(e,d,b)})},i.fadeDeselectedArea=function(){var a=i.chartBodyG().selectAll("rect.bar"),b=i.brush().extent();if(i.isOrdinal())i.hasFilter()?(a.classed(c.constants.SELECTED_CLASS,function(a){return i.hasFilter(a.x)}),a.classed(c.constants.DESELECTED_CLASS,function(a){return!i.hasFilter(a.x)})):(a.classed(c.constants.SELECTED_CLASS,!1),a.classed(c.constants.DESELECTED_CLASS,!1));else if(i.brushIsEmpty(b))a.classed(c.constants.DESELECTED_CLASS,!1);else{var d=b[0],e=b[1];a.classed(c.constants.DESELECTED_CLASS,function(a){return a.x<d||a.x>=e})}},i.centerBar=function(a){return arguments.length?(m=a,i):m},c.override(i,"onClick",function(a){i._onClick(a.data)}),c.override(i,"data",function(){var a=i._data();return l&&a.forEach(function(a){a.values.forEach(function(a){a.y0=0})}),a}),i.barPadding=function(a){return arguments.length?(i._rangeBandPadding(a),j=void 0,i):i._rangeBandPadding()},i._useOuterPadding=function(){return void 0===j},i.outerPadding=i._outerRangeBandPadding,i.gap=function(a){return arguments.length?(j=a,i):j},i.groupGap=function(a){return arguments.length?(k=a,i):k},i.groupBars=function(a){return arguments.length?(l=a,i):l},i.extendBrush=function(){var a=i.brush().extent();return!i.round()||m&&!n||(a[0]=a.map(i.round())[0],a[1]=a.map(i.round())[1],i.chartBodyG().select(".brush").call(i.brush().extent(a))),a},i.alwaysUseRounding=function(a){return arguments.length?(n=a,i):n},i.legendHighlight=function(a){i.isLegendableHidden(a)||i.g().selectAll("rect.bar").classed("highlight",t(a.color)).classed("fadeout",t(a.color,!0))},i.legendReset=function(){i.g().selectAll("rect.bar").classed("highlight",!1).classed("fadeout",!1)},c.override(i,"xAxisMax",function(){var a=this._xAxisMax();if("resolution"in i.xUnits()){var b=i.xUnits().resolution;a+=b}return a}),i.anchor(b,d)},c.lineChart=function(b,d){function w(a,b){return l.getColor.call(a,a.values,b)}function x(b,d){var e=a.svg.line().x(function(a){return l.x()(a.x)}).y(function(a){return l.y()(a.y+a.y0)}).interpolate(r).tension(s);t&&e.defined(t);var f=b.append("path").attr("class","line").attr("stroke",w);u&&f.attr("stroke-dasharray",u),c.transition(d.select("path.line"),l.transitionDuration(),l.transitionDelay()).attr("stroke",w).attr("d",function(a){return z(e(a.values))})}function y(b,d){if(m){var e=a.svg.area().x(function(a){return l.x()(a.x)}).y(function(a){return l.y()(a.y+a.y0)}).y0(function(a){return l.y()(a.y0)}).interpolate(r).tension(s);t&&e.defined(t),b.append("path").attr("class","area").attr("fill",w).attr("d",function(a){return z(e(a.values))}),c.transition(d.select("path.area"),l.transitionDuration(),l.transitionDelay()).attr("fill",w).attr("d",function(a){return z(e(a.values))})}}function z(a){return!a||a.indexOf("NaN")>=0?"M0,0":a}function A(b,d){if("always"===l.xyTipsOn()||!l.brushOn()&&l.xyTipsOn()){var e=f+"-list",h=b.select("g."+e);h.empty()&&(h=b.append("g").attr("class",e)),d.each(function(b,d){var e=b.values;t&&(e=e.filter(t));var i=h.select("g."+f+"._"+d);i.empty()&&(i=h.append("g").attr("class",f+" _"+d)),C(i);var j=i.selectAll("circle."+g).data(e,c.pluck("x"));j.enter().append("circle").attr("class",g).attr("r",F()).style("fill-opacity",p).style("stroke-opacity",q).attr("fill",l.getColor).on("mousemove",function(){var b=a.select(this);D(b),E(b,i)}).on("mouseout",function(){var b=a.select(this);G(b),H(i)}),j.call(I,b),c.transition(j,l.transitionDuration()).attr("cx",function(a){return c.utils.safeNumber(l.x()(a.x))}).attr("cy",function(a){return c.utils.safeNumber(l.y()(a.y+a.y0))}).attr("fill",l.getColor),j.exit().remove()})}}function B(b){b.each(function(b,d){var e=a.select(this),f=e.selectAll("text.lineLabel").data(b.values,c.pluck("x"));f.enter().append("text").attr("class","lineLabel").attr("text-anchor","middle"),c.transition(f,l.transitionDuration()).attr("x",function(a){return c.utils.safeNumber(l.x()(a.x))}).attr("y",function(a){var b=l.y()(a.y+a.y0)-k;return c.utils.safeNumber(b)}).text(function(a){return l.label()(a)}),c.transition(f.exit(),l.transitionDuration()).attr("height",0).remove()})}function C(a){var b=a.select("path."+h).empty()?a.append("path").attr("class",h):a.select("path."+h);b.style("display","none").attr("stroke-dasharray","5,5");var c=a.select("path."+i).empty()?a.append("path").attr("class",i):a.select("path."+i);c.style("display","none").attr("stroke-dasharray","5,5")}function D(a){return a.style("fill-opacity",.8),a.style("stroke-opacity",.8),a.attr("r",n),a}function E(a,b){var c=a.attr("cx"),d=a.attr("cy"),e=l._yAxisX()-l.margins().left,f="M"+e+" "+d+"L"+c+" "+d,g="M"+c+" "+l.yAxisHeight()+"L"+c+" "+d;b.select("path."+h).style("display","").attr("d",f),b.select("path."+i).style("display","").attr("d",g)}function F(){return o||n}function G(a){a.style("fill-opacity",p).style("stroke-opacity",q).attr("r",F())}function H(a){a.select("path."+h).style("display","none"),a.select("path."+i).style("display","none")}function I(a,b){l.renderTitle()&&(a.select("title").remove(),a.append("title").text(c.pluck("data",l.title(b.name))))}function J(b,c,d){return function(){var e=a.select(this),f=e.attr("stroke")===b&&e.attr("stroke-dasharray")===(c instanceof Array?c.join(","):null)||e.attr("fill")===b;return d?!f:f}}var t,u,e=5,f="dc-tooltip",g="dot",h="yRef",i="xRef",j=1e-6,k=3,l=c.stackMixin(c.coordinateGridMixin({})),m=!1,n=e,o=null,p=j,q=j,r="linear",s=.7,v=!0;return l.transitionDuration(500),l.transitionDelay(0),l._rangeBandPadding(1),l.plotData=function(){var a=l.chartBodyG(),b=a.select("g.stack-list");b.empty()&&(b=a.append("g").attr("class","stack-list"));var c=b.selectAll("g.stack").data(l.data()),d=c.enter().append("g").attr("class",function(a,b){return"stack _"+b});x(d,c),y(d,c),A(a,c),l.renderLabel()&&B(c)},l.interpolate=function(a){return arguments.length?(r=a,l):r},l.tension=function(a){return arguments.length?(s=a,l):s},l.defined=function(a){return arguments.length?(t=a,l):t},l.dashStyle=function(a){return arguments.length?(u=a,l):u},l.renderArea=function(a){return arguments.length?(m=a,l):m},l.label(function(a){return c.utils.printSingleValue(a.y0+a.y)},!1),l.xyTipsOn=function(a){return arguments.length?(v=a,l):v},l.dotRadius=function(a){return arguments.length?(n=a,l):n},l.renderDataPoints=function(a){return arguments.length?(a?(p=a.fillOpacity||.8,q=a.strokeOpacity||.8,o=a.radius||2):(p=j,q=j,o=null),l):{fillOpacity:p,strokeOpacity:q,radius:o}},l.legendHighlight=function(a){l.isLegendableHidden(a)||l.g().selectAll("path.line, path.area").classed("highlight",J(a.color,a.dashstyle)).classed("fadeout",J(a.color,a.dashstyle,!0))},l.legendReset=function(){l.g().selectAll("path.line, path.area").classed("highlight",!1).classed("fadeout",!1)},c.override(l,"legendables",function(){var a=l._legendables();return u?a.map(function(a){return a.dashstyle=u,a}):a}),l.anchor(b,d)},c.dataCount=function(b,d){var e=a.format(",d"),f=c.baseMixin({}),g={some:"",all:""};return f.html=function(a){return arguments.length?(a.all&&(g.all=a.all),a.some&&(g.some=a.some),f):g},f.formatNumber=function(a){return arguments.length?(e=a,f):e},f._doRender=function(){var a=f.dimension().size(),b=f.group().value(),c=e(a),d=e(b);return a===b&&""!==g.all?f.root().html(g.all.replace("%total-count",c).replace("%filter-count",d)):""!==g.some?f.root().html(g.some.replace("%total-count",c).replace("%filter-count",d)):(f.selectAll(".total-count").text(c),f.selectAll(".filter-count").text(d)),f},f._doRedraw=function(){return f._doRender()},f.anchor(b,d)},c.dataTable=function(b,d){function r(){var a=!0;if(l.forEach(function(b){a&="function"==typeof b}),!a){var b=j.selectAll("thead").data([0]);b.enter().append("thead"),b.exit().remove();var c=b.selectAll("tr").data([0]);c.enter().append("tr"),c.exit().remove();var d=c.selectAll("th").data(l);d.enter().append("th"),d.exit().remove(),d.attr("class",i).html(function(a){return j._doColumnHeaderFormat(a)})}var f=j.root().selectAll("tbody").data(s(),function(a){return j.keyAccessor()(a)}),g=f.enter().append("tbody");return q===!0&&g.append("tr").attr("class",h).append("td").attr("class",e).attr("colspan",l.length).html(function(a){return j.keyAccessor()(a)}),f.exit().remove(),g}function s(){var b;return b=n===a.ascending?j.dimension().bottom(k):j.dimension().top(k),a.nest().key(j.group()).sortKeys(n).entries(b.sort(function(a,b){return n(m(a),m(b))}).slice(o,p))}function t(a){var b=a.order().selectAll("tr."+f).data(function(a){return a.values}),c=b.enter().append("tr").attr("class",f);return l.forEach(function(a,b){c.append("td").attr("class",g+" _"+b).html(function(b){return j._doColumnValueFormat(a,b)})}),b.exit().remove(),b}var p,e="dc-table-label",f="dc-table-row",g="dc-table-column",h="dc-table-group",i="dc-table-head",j=c.baseMixin({}),k=25,l=[],m=function(a){return a},n=a.ascending,o=0,q=!0;return j._doRender=function(){return j.selectAll("tbody").remove(),t(r()),j},j._doColumnValueFormat=function(a,b){return"function"==typeof a?a(b):"string"==typeof a?b[a]:a.format(b)},j._doColumnHeaderFormat=function(a){return"function"==typeof a?j._doColumnHeaderFnToString(a):"string"==typeof a?j._doColumnHeaderCapitalize(a):String(a.label)},j._doColumnHeaderCapitalize=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},j._doColumnHeaderFnToString=function(a){var b=String(a),c=b.indexOf("return ");if(c>=0){var d=b.lastIndexOf(";");if(d>=0){b=b.substring(c+7,d);var e=b.indexOf("numberFormat");e>=0&&(b=b.replace("numberFormat",""))}}return b},j._doRedraw=function(){return j._doRender()},j.size=function(a){return arguments.length?(k=a,j):k},j.beginSlice=function(a){return arguments.length?(o=a,j):o},j.endSlice=function(a){return arguments.length?(p=a,j):p},j.columns=function(a){return arguments.length?(l=a,j):l},j.sortBy=function(a){return arguments.length?(m=a,j):m},j.order=function(a){return arguments.length?(n=a,j):n},j.showGroups=function(a){return arguments.length?(q=a,j):q},j.anchor(b,d)},c.dataGrid=function(b,d){function q(){var a=i.root().selectAll("div."+h).data(r(),function(a){return i.keyAccessor()(a)}),b=a.enter().append("div").attr("class",h);return p&&b.html(function(a){return p(a)}),a.exit().remove(),b}function r(){var b=i.dimension().top(j);return a.nest().key(i.group()).sortKeys(m).entries(b.sort(function(a,b){return m(l(a),l(b))}).slice(n,o))}function s(a){var b=a.order().selectAll("div."+f).data(function(a){return a.values});return b.enter().append("div").attr("class",f).html(function(a){return k(a)}),b.exit().remove(),b}var o,e="dc-grid-label",f="dc-grid-item",g="dc-grid-group",h="dc-grid-top",i=c.baseMixin({}),j=999,k=function(a){return"you need to provide an html() handling param:  "+JSON.stringify(a)},l=function(a){return a},m=a.ascending,n=0,p=function(a){return"<div class='"+g+"'><h1 class='"+e+"'>"+i.keyAccessor()(a)+"</h1></div>"};return i._doRender=function(){return i.selectAll("div."+h).remove(),s(q()),i},i._doRedraw=function(){return i._doRender()},i.beginSlice=function(a){return arguments.length?(n=a,i):n},i.endSlice=function(a){return arguments.length?(o=a,i):o},i.size=function(a){return arguments.length?(j=a,i):j},i.html=function(a){return arguments.length?(k=a,i):k},i.htmlGroup=function(a){return arguments.length?(p=a,i):p},i.sortBy=function(a){return arguments.length?(l=a,i):l},i.order=function(a){return arguments.length?(m=a,i):m},i.anchor(b,d)},c.bubbleChart=function(b,d){function i(a){var b=a.enter().append("g");b.attr("class",e.BUBBLE_NODE_CLASS).attr("transform",h).append("circle").attr("class",function(a,b){return e.BUBBLE_CLASS+" _"+b}).on("click",e.onClick).attr("fill",e.getColor).attr("r",0),c.transition(a,e.transitionDuration(),e.transitionDelay()).select("circle."+e.BUBBLE_CLASS).attr("r",function(a){return e.bubbleR(a)}).attr("opacity",function(a){return e.bubbleR(a)>0?1:0}),e._doRenderLabel(b),e._doRenderTitles(b)}function j(a){c.transition(a,e.transitionDuration(),e.transitionDelay()).attr("transform",h).select("circle."+e.BUBBLE_CLASS).attr("fill",e.getColor).attr("r",function(a){return e.bubbleR(a)}).attr("opacity",function(a){return e.bubbleR(a)>0?1:0}),e.doUpdateLabels(a),e.doUpdateTitles(a)}function k(a){a.exit().remove()}function l(a){var b=e.x()(e.keyAccessor()(a));return isNaN(b)&&(b=0),b}function m(a){var b=e.y()(e.valueAccessor()(a));return isNaN(b)&&(b=0),b}var e=c.bubbleMixin(c.coordinateGridMixin({})),f=!1,g=!1;e.transitionDuration(750),e.transitionDelay(0);var h=function(a){return"translate("+l(a)+","+m(a)+")"};return e.elasticRadius=function(a){return arguments.length?(f=a,e):f},e.sortBubbleSize=function(a){return arguments.length?(g=a,e):g},e.plotData=function(){f&&e.r().domain([e.rMin(),e.rMax()]),e.r().range([e.MIN_RADIUS,e.xAxisLength()*e.maxBubbleRelativeSize()]);var b=e.data();if(g){var c=e.radiusValueAccessor();b.sort(function(b,d){return a.descending(c(b),c(d))})}var d=e.chartBodyG().selectAll("g."+e.BUBBLE_NODE_CLASS).data(b,function(a){return a.key});g&&d.order(),i(d),j(d),k(d),e.fadeDeselectedArea()},e.renderBrush=function(){},e.redrawBrush=function(){e.fadeDeselectedArea()},e.anchor(b,d)},c.compositeChart=function(b,d){function r(a,b){var c,d,e,f,h;return a&&(c=z(),d=C()),b&&(e=A(),f=D()),g.alignYAxes()&&a&&b&&(h=s(c,d,e,f)),h||{lyAxisMin:c,lyAxisMax:d,ryAxisMin:e,ryAxisMax:f}}function s(a,b,c,d){var e=(d-c)/(b-a);return{lyAxisMin:Math.min(a,c/e),lyAxisMax:Math.max(b,d/e),ryAxisMin:Math.min(c,a*e),ryAxisMax:Math.max(d,b*e)}}function t(b){var c=void 0===g.rightY()||g.elasticY(),d=c||g.resizing();void 0===g.rightY()&&g.rightY(a.scale.linear()),c&&g.rightY().domain([b.ryAxisMin,b.ryAxisMax]),d&&g.rightY().rangeRound([g.yAxisHeight(),0]),g.rightY().range([g.yAxisHeight(),0]),g.rightYAxis(g.rightYAxis().scale(g.rightY())),g.rightYAxis().orient("right")}function u(b){var c=void 0===g.y()||g.elasticY(),d=c||g.resizing();void 0===g.y()&&g.y(a.scale.linear()),c&&g.y().domain([b.lyAxisMin,b.lyAxisMax]),d&&g.y().rangeRound([g.yAxisHeight(),0]),g.y().range([g.yAxisHeight(),0]),g.yAxis(g.yAxis().scale(g.y())),g.yAxis().orient("left")}function v(a,b){a._generateG(g.g()),a.g().attr("class",e+" _"+b)}function w(){return h.filter(function(a){return!a.useRightYAxis()})}function x(){return h.filter(function(a){return a.useRightYAxis()})}function y(a){return a.map(function(a){return a.yAxisMin()})}function z(){return a.min(y(w()))}function A(){return a.min(y(x()))}function B(a){return a.map(function(a){return a.yAxisMax()})}function C(){return c.utils.add(a.max(B(w())),g.yAxisPadding())}function D(){return c.utils.add(a.max(B(x())),g.yAxisPadding())}function E(){return h.map(function(a){return a.xAxisMin()})}function F(){return h.map(function(a){return a.xAxisMax()})}var p,e="sub",f=12,g=c.coordinateGridMixin({}),h=[],i={},j=!1,k=!0,l=!1,m=a.svg.axis(),n=0,o=f,q=!1;return g._mandatoryAttributes([]),g.transitionDuration(500),g.transitionDelay(0),c.override(g,"_generateG",function(){for(var a=this.__generateG(),b=0;b<h.length;++b){var c=h[b];v(c,b),c.dimension()||c.dimension(g.dimension()),c.group()||c.group(g.group()),c.chartGroup(g.chartGroup()),c.svg(g.svg()),c.xUnits(g.xUnits()),c.transitionDuration(g.transitionDuration(),g.transitionDelay()),c.brushOn(g.brushOn()),c.renderTitle(g.renderTitle()),c.elasticX(g.elasticX())}return a}),g._brushing=function(){for(var a=g.extendBrush(),b=g.brushIsEmpty(a),c=0;c<h.length;++c)h[c].replaceFilter(b?null:a)},g._prepareYAxis=function(){var a=0!==w().length,b=0!==x().length,c=r(a,b);a&&u(c),b&&t(c),w().length>0&&!q?g._renderHorizontalGridLinesForAxis(g.g(),g.y(),g.yAxis()):x().length>0&&g._renderHorizontalGridLinesForAxis(g.g(),p,m)},g.renderYAxis=function(){0!==w().length&&(g.renderYAxisAt("y",g.yAxis(),g.margins().left),g.renderYAxisLabel("y",g.yAxisLabel(),-90)),0!==x().length&&(g.renderYAxisAt("yr",g.rightYAxis(),g.width()-g.margins().right),g.renderYAxisLabel("yr",g.rightYAxisLabel(),90,g.width()-o))},g.plotData=function(){for(var a=0;a<h.length;++a){var b=h[a];b.g()||v(b,a),j&&b.colors(g.colors()),b.x(g.x()),b.xAxis(g.xAxis()),b.useRightYAxis()?(b.y(g.rightY()),b.yAxis(g.rightYAxis())):(b.y(g.y()),b.yAxis(g.yAxis())),b.plotData(),b._activateRenderlets()}},g.useRightAxisGridLines=function(a){return arguments?(q=a,g):q},g.childOptions=function(a){return arguments.length?(i=a,h.forEach(function(a){a.options(i)}),g):i},g.fadeDeselectedArea=function(){for(var a=0;a<h.length;++a){var b=h[a];b.brush(g.brush()),b.fadeDeselectedArea()}},g.rightYAxisLabel=function(a,b){return arguments.length?(n=a,g.margins().right-=o,o=void 0===b?f:b,g.margins().right+=o,g):n},g.compose=function(a){return h=a,h.forEach(function(a){a.height(g.height()),a.width(g.width()),a.margins(g.margins()),k&&a.title(g.title()),a.options(i)}),g},g.children=function(){return h},g.shareColors=function(a){return arguments.length?(j=a,g):j},g.shareTitle=function(a){return arguments.length?(k=a,g):k},g.rightY=function(a){return arguments.length?(p=a,g.rescale(),g):p},g.alignYAxes=function(a){return arguments.length?(l=a,g.rescale(),g):l},delete g.yAxisMin,delete g.yAxisMax,c.override(g,"xAxisMin",function(){return c.utils.subtract(a.min(E()),g.xAxisPadding())}),c.override(g,"xAxisMax",function(){return c.utils.add(a.max(F()),g.xAxisPadding())}),g.legendables=function(){return h.reduce(function(a,b){return j&&b.colors(g.colors()),a.push.apply(a,b.legendables()),a},[])},g.legendHighlight=function(a){for(var b=0;b<h.length;++b){var c=h[b];c.legendHighlight(a)}},g.legendReset=function(a){for(var b=0;b<h.length;++b){var c=h[b];c.legendReset(a)}},g.legendToggle=function(){console.log("composite should not be getting legendToggle itself")},g.rightYAxis=function(a){return arguments.length?(m=a,g):m},g.anchor(b,d)},c.seriesChart=function(b,d){function f(b,c){return a.ascending(e.keyAccessor()(b),e.keyAccessor()(c))}function l(a){g[a].g()&&g[a].g().remove(),delete g[a]}function m(){Object.keys(g).map(l),g={}}var i,e=c.compositeChart(b,d),g={},h=c.lineChart,j=a.ascending,k=f;return e._mandatoryAttributes().push("seriesAccessor","chart"),e.shareColors(!0),e._preprocessData=function(){var c,b=[],f=a.nest().key(i);j&&f.sortKeys(j),k&&f.sortValues(k);var m=f.entries(e.data()),n=m.map(function(f,i){var j=g[f.key]||h.call(e,e,d,f.key,i);return g[f.key]||(c=!0),g[f.key]=j,b.push(f.key),j.dimension(e.dimension()).group({all:a.functor(f.values)},f.key).keyAccessor(e.keyAccessor()).valueAccessor(e.valueAccessor()).brushOn(e.brushOn())});Object.keys(g).filter(function(a){return b.indexOf(a)===-1}).forEach(function(a){l(a),c=!0}),e._compose(n),c&&e.legend()&&e.legend().render()},e.chart=function(a){return arguments.length?(h=a,m(),e):h},e.seriesAccessor=function(a){return arguments.length?(i=a,m(),e):i},e.seriesSort=function(a){return arguments.length?(j=a,m(),e):j},e.valueSort=function(a){return arguments.length?(k=a,m(),e):k},e._compose=e.compose,delete e.compose,e},c.geoChoroplethChart=function(b,d){function i(a){var b=j();if(k(a)){var c=l(a);r(c,a,b),s(c,a,b)}}function j(){for(var a={},b=e.data(),c=0;c<b.length;++c)a[e.keyAccessor()(b[c])]=e.valueAccessor()(b[c]);return a}function k(a){return q(a).keyAccessor}function l(a){var b=e.svg().selectAll(m(a)).classed("selected",function(b){return n(a,b)}).classed("deselected",function(b){return o(a,b)}).attr("class",function(b){var d=q(a).name,e=c.utils.nameToId(q(a).keyAccessor(b)),f=d+" "+e;return n(a,b)&&(f+=" selected"),o(a,b)&&(f+=" deselected"),f});return b}function m(a){return"g.layer"+a+" g."+q(a).name}function n(a,b){return e.hasFilter()&&e.hasFilter(p(a,b))}function o(a,b){return e.hasFilter()&&!e.hasFilter(p(a,b))}function p(a,b){return q(a).keyAccessor(b)}function q(a){return h[a]}function r(b,d,f){var g=b.select("path").attr("fill",function(){var b=a.select(this).attr("fill");return b?b:"none"}).on("click",function(a){return e.onClick(a,d)});c.transition(g,e.transitionDuration(),e.transitionDelay()).attr("fill",function(a,b){return e.getColor(f[q(d).keyAccessor(a)],b)})}function s(a,b,c){e.renderTitle()&&a.selectAll("title").text(function(a){var d=p(b,a),f=c[d];return e.title()({key:d,value:f})})}var e=c.colorMixin(c.baseMixin({}));e.colorAccessor(function(a){return a||0});var g,f=a.geo.path(),h=[];return e._doRender=function(){e.resetSvg();for(var a=0;a<h.length;++a){var b=e.svg().append("g").attr("class","layer"+a),c=b.selectAll("g."+q(a).name).data(q(a).data).enter().append("g").attr("class",q(a).name);c.append("path").attr("fill","white").attr("d",f),c.append("title"),i(a)}g=!1},e.onClick=function(a,b){var d=q(b).keyAccessor(a);c.events.trigger(function(){e.filter(d),e.redrawGroup()})},e._doRedraw=function(){for(var a=0;a<h.length;++a)i(a),g&&e.svg().selectAll("g."+q(a).name+" path").attr("d",f);g=!1},e.overlayGeoJson=function(a,b,c){for(var d=0;d<h.length;++d)if(h[d].name===b)return h[d].data=a,h[d].keyAccessor=c,e;return h.push({name:b,data:a,keyAccessor:c}),e},e.projection=function(a){return f.projection(a),g=!0,e},e.geoJsons=function(){return h},e.geoPath=function(){return f},e.removeGeoJson=function(a){for(var b=[],c=0;c<h.length;++c){var d=h[c];d.name!==a&&b.push(d)}return h=b,e},e.anchor(b,d)},c.bubbleOverlay=function(b,d){function k(){return i=h.select("g."+e),i.empty()&&(i=h.svg().append("g").attr("class",e)),i}function l(){var a=m();j.forEach(function(b){var d=n(b,a),e=d.select("circle."+g);e.empty()&&(e=d.append("circle").attr("class",g).attr("r",0).attr("fill",h.getColor).on("click",h.onClick)),c.transition(e,h.transitionDuration(),h.transitionDelay()).attr("r",function(a){return h.bubbleR(a)}),h._doRenderLabel(d),h._doRenderTitles(d)})}function m(){var a={};return h.data().forEach(function(b){a[h.keyAccessor()(b)]=b}),a}function n(a,b){var d=f+" "+c.utils.nameToId(a.name),e=i.select("g."+c.utils.nameToId(a.name));return e.empty()&&(e=i.append("g").attr("class",d).attr("transform","translate("+a.x+","+a.y+")")),e.datum(b[a.name]),e}function o(){var a=m();j.forEach(function(b){var d=n(b,a),e=d.select("circle."+g);c.transition(e,h.transitionDuration(),h.transitionDelay()).attr("r",function(a){return h.bubbleR(a)}).attr("fill",h.getColor),h.doUpdateLabels(d),h.doUpdateTitles(d)})}var i,e="bubble-overlay",f="node",g="bubble",h=c.bubbleMixin(c.baseMixin({})),j=[];return h.transitionDuration(750),h.transitionDelay(0),h.radiusValueAccessor(function(a){return a.value}),h.point=function(a,b,c){return j.push({name:a,x:b,y:c}),h},h._doRender=function(){return i=k(),h.r().range([h.MIN_RADIUS,h.width()*h.maxBubbleRelativeSize()]),
l(),h.fadeDeselectedArea(),h},h._doRedraw=function(){return o(),h.fadeDeselectedArea(),h},h.debug=function(b){if(b){var d=h.select("g."+c.constants.DEBUG_GROUP_CLASS);d.empty()&&(d=h.svg().append("g").attr("class",c.constants.DEBUG_GROUP_CLASS));var e=d.append("text").attr("x",10).attr("y",20);d.append("rect").attr("width",h.width()).attr("height",h.height()).on("mousemove",function(){var b=a.mouse(d.node()),c=b[0]+", "+b[1];e.text(c)})}else h.selectAll(".debug").remove();return h},h.anchor(b,d),h},c.rowChart=function(b,d){function u(){if(!q||r){var b=a.extent(t,p.cappedValueAccessor);b[0]>0&&(b[0]=0),b[1]<0&&(b[1]=0),q=a.scale.linear().domain(b).range([0,p.effectiveWidth()])}s.scale(q)}function v(){var a=e.select("g.axis");u(),a.empty()&&(a=e.append("g").attr("class","axis")),a.attr("transform","translate(0, "+p.effectiveHeight()+")"),c.transition(a,p.transitionDuration(),p.transitionDelay()).call(s)}function w(){e.selectAll("g.tick").select("line.grid-line").remove(),e.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(){return-p.effectiveHeight()})}function x(){t=p.data(),v(),w();var a=e.selectAll("g."+m).data(t);y(a),z(a),B(a)}function y(a){var b=a.enter().append("g").attr("class",function(a,b){return m+" _"+b});b.append("rect").attr("width",0),D(b)}function z(a){a.exit().remove()}function A(){var a=q(0);return a===-(1/0)||a!==a?q(1):a}function B(a){var d,b=t.length;d=l?l:(p.effectiveHeight()-(b+1)*k)/b,h||(g=d/2);var e=a.attr("transform",function(a,b){return"translate(0,"+((b+1)*k+b*d)+")"}).select("rect").attr("height",d).attr("fill",p.getColor).on("click",F).classed("deselected",function(a){return!!p.hasFilter()&&!H(a)}).classed("selected",function(a){return!!p.hasFilter()&&H(a)});c.transition(e,p.transitionDuration(),p.transitionDelay()).attr("width",function(a){return Math.abs(A()-q(p.valueAccessor()(a)))}).attr("transform",G),C(a),E(a)}function C(a){p.renderTitle()&&(a.select("title").remove(),a.append("title").text(p.title()))}function D(a){p.renderLabel()&&a.append("text").on("click",F),p.renderTitleLabel()&&a.append("text").attr("class",n).on("click",F)}function E(a){if(p.renderLabel()){var b=a.select("text").attr("x",f).attr("y",g).attr("dy",i).on("click",F).attr("class",function(a,b){return m+" _"+b}).text(function(a){return p.label()(a)});c.transition(b,p.transitionDuration(),p.transitionDelay()).attr("transform",G)}if(p.renderTitleLabel()){var d=a.select("."+n).attr("x",p.effectiveWidth()-j).attr("y",g).attr("dy",i).attr("text-anchor","end").on("click",F).attr("class",function(a,b){return n+" _"+b}).text(function(a){return p.title()(a)});c.transition(d,p.transitionDuration(),p.transitionDelay()).attr("transform",G)}}function F(a){p.onClick(a)}function G(a){var b=q(p.cappedValueAccessor(a)),c=A(),d=b>c?c:b;return"translate("+d+",0)"}function H(a){return p.hasFilter(p.cappedKeyAccessor(a))}var e,q,r,t,f=10,g=15,h=!1,i="0.35em",j=2,k=5,l=!1,m="row",n="titlerow",o=!1,p=c.capMixin(c.marginMixin(c.colorMixin(c.baseMixin({})))),s=a.svg.axis().orient("bottom");return p.rowsCap=p.cap,p._doRender=function(){return p.resetSvg(),e=p.svg().append("g").attr("transform","translate("+p.margins().left+","+p.margins().top+")"),x(),p},p.title(function(a){return p.cappedKeyAccessor(a)+": "+p.cappedValueAccessor(a)}),p.label(p.cappedKeyAccessor),p.x=function(a){return arguments.length?(q=a,p):q},p.renderTitleLabel=function(a){return arguments.length?(o=a,p):o},p._doRedraw=function(){return x(),p},p.xAxis=function(){return s},p.fixedBarHeight=function(a){return arguments.length?(l=a,p):l},p.gap=function(a){return arguments.length?(k=a,p):k},p.elasticX=function(a){return arguments.length?(r=a,p):r},p.labelOffsetX=function(a){return arguments.length?(f=a,p):f},p.labelOffsetY=function(a){return arguments.length?(g=a,h=!0,p):g},p.titleLabelOffsetX=function(a){return arguments.length?(j=a,p):j},p.anchor(b,d)},c.legend=function(){function p(){return h+g}var d,n,o,a=2,b={},e=0,f=0,g=12,h=5,i=!1,j=560,k=70,l=!1,m=c.pluck("name");return b.parent=function(a){return arguments.length?(d=a,b):d},b.render=function(){d.svg().select("g.dc-legend").remove(),o=d.svg().append("g").attr("class","dc-legend").attr("transform","translate("+e+","+f+")");var b=d.legendables();void 0!==n&&(b=b.slice(0,n));var q=o.selectAll("g.dc-legend-item").data(b).enter().append("g").attr("class","dc-legend-item").on("mouseover",function(a){d.legendHighlight(a)}).on("mouseout",function(a){d.legendReset(a)}).on("click",function(a){a.chart.legendToggle(a)});o.selectAll("g.dc-legend-item").classed("fadeout",function(a){return a.chart.isLegendableHidden(a)}),b.some(c.pluck("dashstyle"))?q.append("line").attr("x1",0).attr("y1",g/2).attr("x2",g).attr("y2",g/2).attr("stroke-width",2).attr("stroke-dasharray",c.pluck("dashstyle")).attr("stroke",c.pluck("color")):q.append("rect").attr("width",g).attr("height",g).attr("fill",function(a){return a?a.color:"blue"}),q.append("text").text(m).attr("x",g+a).attr("y",function(){return g/2+(this.clientHeight?this.clientHeight:13)/2-2});var r=0,s=0;q.attr("transform",function(a,b){if(i){var c=l===!0?this.getBBox().width+h:k;r+c>j&&r>0&&(++s,r=0);var d="translate("+r+","+s*p()+")";return r+=c,d}return"translate(0,"+b*p()+")"})},b.x=function(a){return arguments.length?(e=a,b):e},b.y=function(a){return arguments.length?(f=a,b):f},b.gap=function(a){return arguments.length?(h=a,b):h},b.itemHeight=function(a){return arguments.length?(g=a,b):g},b.horizontal=function(a){return arguments.length?(i=a,b):i},b.legendWidth=function(a){return arguments.length?(j=a,b):j},b.itemWidth=function(a){return arguments.length?(k=a,b):k},b.autoItemWidth=function(a){return arguments.length?(l=a,b):l},b.legendText=function(a){return arguments.length?(m=a,b):m},b.maxItems=function(a){return arguments.length?(n=c.utils.isNumber(a)?a:void 0,b):n},b},c.scatterPlot=function(b,d){function t(a,b){e.renderTitle()&&(a.selectAll("title").remove(),a.append("title").text(function(a){return e.title()(a)}))}function u(b,d){var g=e.selectAll(".chart-body path.symbol").filter(function(){return b(a.select(this))}),h=f.size();f.size(Math.pow(d,2)),c.transition(g,e.transitionDuration(),e.transitionDelay()).attr("d",f),f.size(h)}var e=c.coordinateGridMixin({}),f=a.svg.symbol(),g=function(a){return a.value},h=e.keyAccessor();e.keyAccessor(function(a){return h(a)[0]}),e.valueAccessor(function(a){return h(a)[1]}),e.colorAccessor(function(){return e._groupName}),e.title(function(a){return e.keyAccessor()(a)+","+e.valueAccessor()(a)+": "+e.existenceAccessor()(a)});var i=function(a){return"translate("+e.x()(e.keyAccessor()(a))+","+e.y()(e.valueAccessor()(a))+")"},j=7,k=5,l=3,m=null,n=1,o=0,p=0,q=1,r=null,s=[];return f.size(function(a,b){return g(a)?s[b]?Math.pow(k,2):Math.pow(l,2):Math.pow(o,2)}),c.override(e,"_filter",function(a){return arguments.length?e.__filter(c.filters.RangedTwoDimensionalFilter(a)):e.__filter()}),e.plotData=function(){var a=e.chartBodyG().selectAll("path.symbol").data(e.data());a.enter().append("path").attr("class","symbol").attr("opacity",0).attr("fill",e.getColor).attr("transform",i),a.call(t,e.data()),a.each(function(a,b){s[b]=!e.filter()||e.filter().isFiltered([a.key[0],a.key[1]])}),c.transition(a,e.transitionDuration(),e.transitionDelay()).attr("opacity",function(a,b){return g(a)?s[b]?q:e.excludedOpacity():p}).attr("fill",function(a,b){return r&&!g(a)?r:e.excludedColor()&&!s[b]?e.excludedColor():e.getColor(a)}).attr("transform",i).attr("d",f),c.transition(a.exit(),e.transitionDuration(),e.transitionDelay()).attr("opacity",0).remove()},e.existenceAccessor=function(a){return arguments.length?(g=a,this):g},e.symbol=function(a){return arguments.length?(f.type(a),e):f.type()},e.symbolSize=function(a){return arguments.length?(k=a,e):k},e.highlightedSize=function(a){return arguments.length?(j=a,e):j},e.excludedSize=function(a){return arguments.length?(l=a,e):l},e.excludedColor=function(a){return arguments.length?(m=a,e):m},e.excludedOpacity=function(a){return arguments.length?(n=a,e):n},e.hiddenSize=e.emptySize=function(a){return arguments.length?(o=a,e):o},e.emptyColor=function(a){return arguments.length?(r=a,e):r},e.emptyOpacity=function(a){return arguments.length?(p=a,e):p},e.nonemptyOpacity=function(a){return arguments.length?(q=a,e):p},e.legendables=function(){return[{chart:e,name:e._groupName,color:e.getColor()}]},e.legendHighlight=function(b){u(function(a){return a.attr("fill")===b.color},j),e.selectAll(".chart-body path.symbol").filter(function(){return a.select(this).attr("fill")!==b.color}).classed("fadeout",!0)},e.legendReset=function(b){u(function(a){return a.attr("fill")===b.color},k),e.selectAll(".chart-body path.symbol").filter(function(){return a.select(this).attr("fill")!==b.color}).classed("fadeout",!1)},e.setHandlePaths=function(){},e.extendBrush=function(){var a=e.brush().extent();return e.round()&&(a[0]=a[0].map(e.round()),a[1]=a[1].map(e.round()),e.g().select(".brush").call(e.brush().extent(a))),a},e.brushIsEmpty=function(a){return e.brush().empty()||!a||a[0][0]>=a[1][0]||a[0][1]>=a[1][1]},e._brushing=function(){var a=e.extendBrush();if(e.redrawBrush(e.g()),e.brushIsEmpty(a))c.events.trigger(function(){e.filter(null),e.redrawGroup()});else{var b=c.filters.RangedTwoDimensionalFilter(a);c.events.trigger(function(){e.filter(null),e.filter(b),e.redrawGroup()},c.constants.EVENT_DELAY)}},e.setBrushY=function(a){a.call(e.brush().y(e.y()))},e.anchor(b,d)},c.numberDisplay=function(b,d){var i,e="number-display",f=a.format(".2s"),g=c.baseMixin({}),h={one:"",some:"",none:""};return g._mandatoryAttributes(["group"]),g.html=function(a){return arguments.length?(a.none?h.none=a.none:a.one?h.none=a.one:a.some&&(h.none=a.some),a.one?h.one=a.one:a.some&&(h.one=a.some),a.some?h.some=a.some:a.one&&(h.some=a.one),g):h},g.value=function(){return g.data()},g.data(function(a){var b=a.value?a.value():a.top(1)[0];return g.valueAccessor()(b)}),g.transitionDuration(250),g.transitionDelay(0),g._doRender=function(){var b=g.value(),c=g.selectAll("."+e);c.empty()&&(c=c.data([0]).enter().append("span").attr("class",e)),c.transition().duration(g.transitionDuration()).delay(g.transitionDelay()).ease("quad-out-in").tween("text",function(){var c=isFinite(i)?i:0,d=a.interpolateNumber(c||0,b);return i=b,function(a){var c=null,e=g.formatNumber()(d(a));0===b&&""!==h.none?c=h.none:1===b&&""!==h.one?c=h.one:""!==h.some&&(c=h.some),this.innerHTML=c?c.replace("%number",e):e}})},g._doRedraw=function(){return g._doRender()},g.formatNumber=function(a){return arguments.length?(f=a,g):f},g.anchor(b,d)},c.heatMap=function(b,d){function u(a,b){var d=o.selectAll(".box-group").filter(function(c){return c.key[a]===b}),e=d.filter(function(a){return!o.hasFilter(a.key)});c.events.trigger(function(){var a=e.empty()?d:e,b=a.data().map(function(a){return c.filters.TwoDimensionalFilter(a.key)});o._filter([b]),o.redrawGroup()})}var f,g,h,e=6.75,i=a.ascending,j=a.ascending,k=a.scale.ordinal(),l=a.scale.ordinal(),m=e,n=e,o=c.colorMixin(c.marginMixin(c.baseMixin({})));o._mandatoryAttributes(["group"]),o.title(o.colorAccessor());var p=function(a){return a},q=function(a){return a};o.colsLabel=function(a){return arguments.length?(p=a,o):p},o.rowsLabel=function(a){return arguments.length?(q=a,o):q};var r=function(a){u(0,a)},s=function(a){u(1,a)},t=function(a){var b=a.key;c.events.trigger(function(){o.filter(b),o.redrawGroup()})};return c.override(o,"filter",function(a){return arguments.length?o._filter(c.filters.TwoDimensionalFilter(a)):o._filter()}),o.rows=function(a){return arguments.length?(h=a,o):h},o.rowOrdering=function(a){return arguments.length?(j=a,o):j},o.cols=function(a){return arguments.length?(g=a,o):g},o.colOrdering=function(a){return arguments.length?(i=a,o):i},o._doRender=function(){return o.resetSvg(),f=o.svg().append("g").attr("class","heatmap").attr("transform","translate("+o.margins().left+","+o.margins().top+")"),o._doRedraw()},o._doRedraw=function(){var a=o.data(),b=o.rows()||a.map(o.valueAccessor()),d=o.cols()||a.map(o.keyAccessor());j&&(b=b.sort(j)),i&&(d=d.sort(i)),b=l.domain(b),d=k.domain(d);var e=b.domain().length,g=d.domain().length,h=Math.floor(o.effectiveWidth()/g),p=Math.floor(o.effectiveHeight()/e);d.rangeRoundBands([0,o.effectiveWidth()]),b.rangeRoundBands([o.effectiveHeight(),0]);var q=f.selectAll("g.box-group").data(o.data(),function(a,b){return o.keyAccessor()(a,b)+"\0"+o.valueAccessor()(a,b)}),r=q.enter().append("g").attr("class","box-group");r.append("rect").attr("class","heat-box").attr("fill","white").on("click",o.boxOnClick()),o.renderTitle()&&(r.append("title"),q.select("title").text(o.title())),c.transition(q.select("rect"),o.transitionDuration(),o.transitionDelay()).attr("x",function(a,b){return d(o.keyAccessor()(a,b))}).attr("y",function(a,c){return b(o.valueAccessor()(a,c))}).attr("rx",m).attr("ry",n).attr("fill",o.getColor).attr("width",h).attr("height",p),q.exit().remove();var s=f.select("g.cols");s.empty()&&(s=f.append("g").attr("class","cols axis"));var t=s.selectAll("text").data(d.domain());t.enter().append("text").attr("x",function(a){return d(a)+h/2}).style("text-anchor","middle").attr("y",o.effectiveHeight()).attr("dy",12).on("click",o.xAxisOnClick()).text(o.colsLabel()),c.transition(t,o.transitionDuration(),o.transitionDelay()).text(o.colsLabel()).attr("x",function(a){return d(a)+h/2}).attr("y",o.effectiveHeight()),t.exit().remove();var u=f.select("g.rows");u.empty()&&(u=f.append("g").attr("class","rows axis"));var v=u.selectAll("text").data(b.domain());return v.enter().append("text").attr("dy",6).style("text-anchor","end").attr("x",0).attr("dx",-2).on("click",o.yAxisOnClick()).text(o.rowsLabel()),c.transition(v,o.transitionDuration(),o.transitionDelay()).text(o.rowsLabel()).attr("y",function(a){return b(a)+p/2}),v.exit().remove(),o.hasFilter()?o.selectAll("g.box-group").each(function(a){o.isSelectedNode(a)?o.highlightSelected(this):o.fadeDeselected(this)}):o.selectAll("g.box-group").each(function(){o.resetHighlight(this)}),o},o.boxOnClick=function(a){return arguments.length?(t=a,o):t},o.xAxisOnClick=function(a){return arguments.length?(r=a,o):r},o.yAxisOnClick=function(a){return arguments.length?(s=a,o):s},o.xBorderRadius=function(a){return arguments.length?(m=a,o):m},o.yBorderRadius=function(a){return arguments.length?(n=a,o):n},o.isSelectedNode=function(a){return o.hasFilter(a.key)},o.anchor(b,d)},function(){function b(a){return[0,a.length-1]}function c(b){return[a.quantile(b,.25),a.quantile(b,.5),a.quantile(b,.75)]}a.box=function(){function m(b){b.each(function(b,c){b=b.map(i).sort(a.ascending);var m=a.select(this),n=b.length,o=b[0],p=b[n-1],q=b.quartiles=k(b),r=j&&j.call(this,b,c),s=r&&r.map(function(a){return b[a]}),t=r?a.range(0,r[0]).concat(a.range(r[1]+1,n)):a.range(n),u=a.scale.linear().domain(h&&h.call(this,b,c)||[o,p]).range([e,0]),v=this.__chart__||a.scale.linear().domain([0,1/0]).range(u.range());this.__chart__=u;var w=m.selectAll("line.center").data(s?[s]:[]);w.enter().insert("line","rect").attr("class","center").attr("x1",d/2).attr("y1",function(a){return v(a[0])}).attr("x2",d/2).attr("y2",function(a){return v(a[1])}).style("opacity",1e-6).transition().duration(f).delay(g).style("opacity",1).attr("y1",function(a){return u(a[0])}).attr("y2",function(a){return u(a[1])}),w.transition().duration(f).delay(g).style("opacity",1).attr("x1",d/2).attr("x2",d/2).attr("y1",function(a){return u(a[0])}).attr("y2",function(a){return u(a[1])}),w.exit().transition().duration(f).delay(g).style("opacity",1e-6).attr("y1",function(a){return u(a[0])}).attr("y2",function(a){return u(a[1])}).remove();var x=m.selectAll("rect.box").data([q]);x.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(a){return v(a[2])}).attr("width",d).attr("height",function(a){return v(a[0])-v(a[2])}).transition().duration(f).delay(g).attr("y",function(a){return u(a[2])}).attr("height",function(a){return u(a[0])-u(a[2])}),x.transition().duration(f).delay(g).attr("width",d).attr("y",function(a){return u(a[2])}).attr("height",function(a){return u(a[0])-u(a[2])});var y=m.selectAll("line.median").data([q[1]]);y.enter().append("line").attr("class","median").attr("x1",0).attr("y1",v).attr("x2",d).attr("y2",v).transition().duration(f).delay(g).attr("y1",u).attr("y2",u),y.transition().duration(f).delay(g).attr("x1",0).attr("x2",d).attr("y1",u).attr("y2",u);var z=m.selectAll("line.whisker").data(s||[]);z.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",v).attr("x2",d).attr("y2",v).style("opacity",1e-6).transition().duration(f).delay(g).attr("y1",u).attr("y2",u).style("opacity",1),z.transition().duration(f).delay(g).attr("x1",0).attr("x2",d).attr("y1",u).attr("y2",u).style("opacity",1),z.exit().transition().duration(f).delay(g).attr("y1",u).attr("y2",u).style("opacity",1e-6).remove();var A=m.selectAll("circle.outlier").data(t,Number);A.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",d/2).attr("cy",function(a){return v(b[a])}).style("opacity",1e-6).transition().duration(f).delay(g).attr("cy",function(a){return u(b[a])}).style("opacity",1),A.transition().duration(f).delay(g).attr("cx",d/2).attr("cy",function(a){return u(b[a])}).style("opacity",1),A.exit().transition().duration(f).delay(g).attr("cy",function(a){return u(b[a])}).style("opacity",1e-6).remove();var B=l||u.tickFormat(8),C=m.selectAll("text.box").data(q);C.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(a,b){return 1&b?6:-6}).attr("x",function(a,b){return 1&b?d:0}).attr("y",v).attr("text-anchor",function(a,b){return 1&b?"start":"end"}).text(B).transition().duration(f).delay(g).attr("y",u),C.transition().duration(f).delay(g).text(B).attr("x",function(a,b){return 1&b?d:0}).attr("y",u);var D=m.selectAll("text.whisker").data(s||[]);D.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",d).attr("y",v).text(B).style("opacity",1e-6).transition().duration(f).delay(g).attr("y",u).style("opacity",1),D.transition().duration(f).delay(g).text(B).attr("x",d).attr("y",u).style("opacity",1),D.exit().transition().duration(f).delay(g).attr("y",u).style("opacity",1e-6).remove()}),a.timer.flush()}var d=1,e=1,f=0,g=0,h=null,i=Number,j=b,k=c,l=null;return m.width=function(a){return arguments.length?(d=a,m):d},m.height=function(a){return arguments.length?(e=a,m):e},m.tickFormat=function(a){return arguments.length?(l=a,m):l},m.duration=function(a){return arguments.length?(f=a,m):f},m.domain=function(b){return arguments.length?(h=null===b?b:a.functor(b),m):h},m.value=function(a){return arguments.length?(i=a,m):i},m.whiskers=function(a){return arguments.length?(j=a,m):j},m.quartiles=function(a){return arguments.length?(k=a,m):k},m}}(),c.boxPlot=function(b,d){function f(a){return function(b){var c=b.quartiles[0],d=b.quartiles[2],e=(d-c)*a,f=-1,g=b.length;do++f;while(b[f]<c-e);do--g;while(b[g]>d+e);return[f,g]}}function n(a){var b=a.enter().append("g");b.attr("class","box").attr("transform",m).call(j).on("click",function(a){e.filter(e.keyAccessor()(a)),e.redrawGroup()})}function o(b){c.transition(b,e.transitionDuration(),e.transitionDelay()).attr("transform",m).call(j).each(function(){a.select(this).select("rect.box").attr("fill",e.getColor)})}function p(a){a.exit().remove().call(j)}var e=c.coordinateGridMixin({}),g=1.5,h=f,i=h(g),j=a.box(),k=null,l=function(a,b){return e.isOrdinal()?e.x().rangeBand():a/(1+e.boxPadding())/b};e.yAxisPadding(12),e.x(a.scale.ordinal()),e.xUnits(c.units.ordinal),e.data(function(a){return a.all().map(function(a){return a.map=function(b){return b.call(a,a)},a}).filter(function(a){var b=e.valueAccessor()(a);return 0!==b.length})}),e.boxPadding=e._rangeBandPadding,e.boxPadding(.8),e.outerPadding=e._outerRangeBandPadding,e.outerPadding(.5),e.boxWidth=function(b){return arguments.length?(l=a.functor(b),e):l};var m=function(a,b){var c=e.x()(e.keyAccessor()(a,b));return"translate("+c+", 0)"};return e._preprocessData=function(){e.elasticX()&&e.x().domain([])},e.plotData=function(){var a=l(e.effectiveWidth(),e.xUnitCount());j.whiskers(i).width(a).height(e.effectiveHeight()).value(e.valueAccessor()).domain(e.y().domain()).duration(e.transitionDuration()).tickFormat(k);var b=e.chartBodyG().selectAll("g.box").data(e.data(),e.keyAccessor());n(b),o(b),p(b),e.fadeDeselectedArea()},e.fadeDeselectedArea=function(){if(e.hasFilter())if(e.isOrdinal())e.g().selectAll("g.box").each(function(a){e.isSelectedNode(a)?e.highlightSelected(this):e.fadeDeselected(this)});else{var a=e.brush().extent(),b=a[0],c=a[1],d=e.keyAccessor();e.g().selectAll("g.box").each(function(a){var f=d(a);f<b||f>=c?e.fadeDeselected(this):e.highlightSelected(this)})}else e.g().selectAll("g.box").each(function(){e.resetHighlight(this)})},e.isSelectedNode=function(a){return e.hasFilter(e.keyAccessor()(a))},e.yAxisMin=function(){var b=a.min(e.data(),function(b){return a.min(e.valueAccessor()(b))});return c.utils.subtract(b,e.yAxisPadding())},e.yAxisMax=function(){var b=a.max(e.data(),function(b){return a.max(e.valueAccessor()(b))});return c.utils.add(b,e.yAxisPadding())},e.tickFormat=function(a){return arguments.length?(k=a,e):k},e.anchor(b,d)},c.selectMenu=function(b,d){function o(){var a=h.selectAll("option."+f).data(g.data(),function(a){return g.keyAccessor()(a)});return a.enter().append("option").classed(f,!0).attr("value",function(a){return g.keyAccessor()(a)}),a.text(g.title()),a.exit().remove(),h.selectAll("option."+f).sort(m),h.on("change",p),a}function p(b,c){var d,e=a.event.target;if(e.selectedOptions){var f=Array.prototype.slice.call(e.selectedOptions);d=f.map(function(a){return a.value})}else{var h=[].slice.call(a.event.target.options);d=h.filter(function(a){return a.selected}).map(function(a){return a.value})}1===d.length&&""===d[0]?d=k||null:j||1!==d.length||(d=d[0]),g.onChange(d)}function q(){j?h.attr("multiple",!0):h.attr("multiple",null),null!==l?h.attr("size",l):h.attr("size",null)}var h,e="dc-select-menu",f="dc-select-option",g=c.baseMixin({}),i="Select all",j=!1,k=null,l=null,m=function(a,b){return g.keyAccessor()(a)>g.keyAccessor()(b)?1:g.keyAccessor()(b)>g.keyAccessor()(a)?-1:0},n=function(a){return g.valueAccessor()(a)>0};return g.data(function(a){return a.all().filter(n)}),g._doRender=function(){return g.select("select").remove(),h=g.root().append("select").classed(e,!0),h.append("option").text(i).attr("value",""),g._doRedraw(),g},g._doRedraw=function(){return q(),o(),g.hasFilter()&&j?h.selectAll("option").property("selected",function(a){return a&&g.filters().indexOf(String(g.keyAccessor()(a)))>=0}):g.hasFilter()?h.property("value",g.filter()):h.property("value",""),g},g.onChange=function(a){a&&j?g.replaceFilter([a]):a?g.replaceFilter(a):g.filterAll(),c.events.trigger(function(){g.redrawGroup()})},g.order=function(a){return arguments.length?(m=a,g):m},g.promptText=function(a){return arguments.length?(i=a,g):i},g.filterDisplayed=function(a){return arguments.length?(n=a,g):n},g.multiple=function(a){return arguments.length?(j=a,g):j},g.promptValue=function(a){return arguments.length?(k=a,g):k},g.numberVisible=function(a){return arguments.length?(l=a,g):l},g.size=c.logger.deprecate(g.numberVisible,"selectMenu.size is ambiguous - use numberVisible instead"),g.anchor(b,d)},c.abstractBubbleChart=c.bubbleMixin,c.baseChart=c.baseMixin,c.capped=c.capMixin,c.colorChart=c.colorMixin,c.coordinateGridChart=c.coordinateGridMixin,c.marginable=c.marginMixin,c.stackableChart=c.stackMixin,c.d3=a,c.crossfilter=b,c}if("function"==typeof define&&define.amd)define(["d3","crossfilter"],a);else if("object"==typeof module&&module.exports){var b=require("d3"),c=require("crossfilter2");"function"!=typeof c&&(c=c.crossfilter),module.exports=a(b,c)}else this.dc=a(d3,crossfilter)}();